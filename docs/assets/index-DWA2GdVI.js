var is=Object.defineProperty;var rs=(n,t,e)=>t in n?is(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var B=(n,t,e)=>rs(n,typeof t!="symbol"?t+"":t,e);import{$ as ze,a0 as fn,Z as $t,r as W,o as M,c as V,a as C,a1 as ie,l as L,a2 as os,e as Oe,O as as,a3 as ls,h as y,w as E,f as m,s as I,n as yt,L as Nt,x as zt,F as Ot,b as Ht,y as Lt,S as jt,U as Wt,d as it,a4 as re,a5 as tn,R as us,t as hs,a6 as cs,a7 as ds,k as Ft,a8 as pn,a9 as fs,aa as mn,ab as gn,ac as Zt,W as en,Y as nn,V as ps,j as Kt}from"./index-DZFCHy6p.js";import{_ as nt}from"./plugin-vueexport-helper-DlAUqK2U.js";import{E as ms}from"./core-D5d8HsbF.js";const yn=Symbol("CANVAS_PROVIDE_KEY"),gs=n=>{ze(yn,n)},oe=()=>fn(yn);function ys(){$.width=320,$.height=512}const $=$t({width:320,height:512,minWrapperWidth:1200,minWrapperHeight:800});function be(n,t){$.width=n,$.height=t}const Jt={TEXT_PANEL:"text-panel",BACKGROUND_PANEL:"background-panel",LINE_PANEL:"line-panel",RECT_PANEL:"rect-panel"},ut=W([]);function bn(){ut.value=[]}function bs(){const[n]=ut.value;n.target.select()}function wn(n=ut.value){return!Array.isArray(n)||n.length===0?[]:n.map(t=>{const e={id:t.id,label:t.label,type:t.type,attr:{},children:[]};return t.type===Jt.BACKGROUND_PANEL&&Object.assign(e.attr,{width:t.target.getWidth(),height:t.target.getHeight(),fill:t.target.getFill()}),t.type===Jt.TEXT_PANEL&&Object.assign(e.attr,{x:t.target.getX(),y:t.target.getY(),content:t.target.getText(),fontSize:t.target.getSize(),fill:t.target.getFill(),fontFamily:t.target.getFontFamily(),fontWeight:t.target.getWeight(),fontStyle:t.target.getFontStyle()}),t.type===Jt.LINE_PANEL&&Object.assign(e.attr,{plot:t.target.getPlot(),color:t.target.getColor(),strokeWidth:t.target.getStrokeWidth(),strokeDasharray:t.target.getStrokeDasharray(),transform:t.target.getTransform()}),t.type===Jt.RECT_PANEL&&Object.assign(e.attr,{fill:t.target.getFill(),width:t.target.getWidth(),height:t.target.getHeight(),color:t.target.getColor(),strokeWidth:t.target.getStrokeWidth(),strokeDasharray:t.target.getStrokeDasharray(),x:t.target.getX(),y:t.target.getY(),transform:t.target.getTransform()}),t.children&&Array.isArray(t.children)&&(e.children=wn(t.children)),e})}const ws={class:"m-svg-toolbar"},_s={__name:"index",setup(n){const t=oe();function e(){t.clearCanvas()}function s(){t.saveCanvasText()}function i(){t.textManager.addText(10,20,"你好")}return(r,o)=>(M(),V("div",ws,[C("button",{onClick:e},"清空"),C("button",{onClick:s},"保存"),C("button",{onClick:i},"加入文本")]))}},xs=nt(_s,[["__scopeId","data-v-980253f2"]]),we={},_n=[];function v(n,t){if(Array.isArray(n)){for(const e of n)v(e,t);return}if(typeof n=="object"){for(const e in n)v(e,n[e]);return}xn(Object.getOwnPropertyNames(t)),we[n]=Object.assign(we[n]||{},t)}function q(n){return we[n]||{}}function vs(){return[...new Set(_n)]}function xn(n){_n.push(...n)}function He(n,t){let e;const s=n.length,i=[];for(e=0;e<s;e++)i.push(t(n[e]));return i}function Es(n,t){let e;const s=n.length,i=[];for(e=0;e<s;e++)t(n[e])&&i.push(n[e]);return i}function de(n){return n%360*Math.PI/180}function Ts(n){return n.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()})}function vn(n){return n.charAt(0).toUpperCase()+n.slice(1)}function Dt(n,t,e,s){return(t==null||e==null)&&(s=s||n.bbox(),t==null?t=s.width/s.height*e:e==null&&(e=s.height/s.width*t)),{width:t,height:e}}function _e(n,t){const e=n.origin;let s=n.ox!=null?n.ox:n.originX!=null?n.originX:"center",i=n.oy!=null?n.oy:n.originY!=null?n.originY:"center";e!=null&&([s,i]=Array.isArray(e)?e:typeof e=="object"?[e.x,e.y]:[e,e]);const r=typeof s=="string",o=typeof i=="string";if(r||o){const{height:a,width:l,x:u,y:h}=t.bbox();r&&(s=s.includes("left")?u:s.includes("right")?u+l:u+l/2),o&&(i=i.includes("top")?h:i.includes("bottom")?h+a:h+a/2)}return[s,i]}const Ss=new Set(["desc","metadata","title"]),xe=n=>Ss.has(n.nodeName),En=(n,t,e={})=>{const s={...t};for(const i in s)s[i].valueOf()===e[i]&&delete s[i];Object.keys(s).length?n.node.setAttribute("data-svgjs",JSON.stringify(s)):(n.node.removeAttribute("data-svgjs"),n.node.removeAttribute("svgjs:data"))},Le="http://www.w3.org/2000/svg",As="http://www.w3.org/1999/xhtml",fe="http://www.w3.org/2000/xmlns/",Yt="http://www.w3.org/1999/xlink",T={window:typeof window>"u"?null:window,document:typeof document>"u"?null:document};function qt(){return T.window}class Ie{}const gt={},Ve="___SYMBOL___ROOT___";function It(n,t=Le){return T.document.createElementNS(t,n)}function j(n,t=!1){if(n instanceof Ie)return n;if(typeof n=="object")return pe(n);if(n==null)return new gt[Ve];if(typeof n=="string"&&n.charAt(0)!=="<")return pe(T.document.querySelector(n));const e=t?T.document.createElement("div"):It("svg");return e.innerHTML=n,n=pe(e.firstChild),e.removeChild(e.firstChild),n}function R(n,t){return t&&(t instanceof T.window.Node||t.ownerDocument&&t instanceof t.ownerDocument.defaultView.Node)?t:It(n)}function Z(n){if(!n)return null;if(n.instance instanceof Ie)return n.instance;if(n.nodeName==="#document-fragment")return new gt.Fragment(n);let t=vn(n.nodeName||"Dom");return t==="LinearGradient"||t==="RadialGradient"?t="Gradient":gt[t]||(t="Dom"),new gt[t](n)}let pe=Z;function S(n,t=n.name,e=!1){return gt[t]=n,e&&(gt[Ve]=n),xn(Object.getOwnPropertyNames(n.prototype)),n}function Ds(n){return gt[n]}let Cs=1e3;function Tn(n){return"Svgjs"+vn(n)+Cs++}function Sn(n){for(let t=n.children.length-1;t>=0;t--)Sn(n.children[t]);return n.id&&(n.id=Tn(n.nodeName)),n}function x(n,t){let e,s;for(n=Array.isArray(n)?n:[n],s=n.length-1;s>=0;s--)for(e in t)n[s].prototype[e]=t[e]}function F(n){return function(...t){const e=t[t.length-1];return e&&e.constructor===Object&&!(e instanceof Array)?n.apply(this,t.slice(0,-1)).attr(e):n.apply(this,t)}}function ks(){return this.parent().children()}function Ms(){return this.parent().index(this)}function Ps(){return this.siblings()[this.position()+1]}function Fs(){return this.siblings()[this.position()-1]}function Rs(){const n=this.position();return this.parent().add(this.remove(),n+1),this}function Ns(){const n=this.position();return this.parent().add(this.remove(),n?n-1:0),this}function zs(){return this.parent().add(this.remove()),this}function Os(){return this.parent().add(this.remove(),0),this}function Hs(n){n=j(n),n.remove();const t=this.position();return this.parent().add(n,t),this}function Ls(n){n=j(n),n.remove();const t=this.position();return this.parent().add(n,t+1),this}function Is(n){return n=j(n),n.before(this),this}function Vs(n){return n=j(n),n.after(this),this}v("Dom",{siblings:ks,position:Ms,next:Ps,prev:Fs,forward:Rs,backward:Ns,front:zs,back:Os,before:Hs,after:Ls,insertBefore:Is,insertAfter:Vs});const An=/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,Bs=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,$s=/rgb\((\d+),(\d+),(\d+)\)/,js=/(#[a-z_][a-z0-9\-_]*)/i,Ws=/\)\s*,?\s*/,Ys=/\s/g,sn=/^#[a-f0-9]{3}$|^#[a-f0-9]{6}$/i,rn=/^rgb\(/,on=/^(\s+)?$/,an=/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,qs=/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,at=/[\s,]+/,Be=/[MLHVCSQTAZ]/i;function Us(){const n=this.attr("class");return n==null?[]:n.trim().split(at)}function Xs(n){return this.classes().indexOf(n)!==-1}function Gs(n){if(!this.hasClass(n)){const t=this.classes();t.push(n),this.attr("class",t.join(" "))}return this}function Ks(n){return this.hasClass(n)&&this.attr("class",this.classes().filter(function(t){return t!==n}).join(" ")),this}function Js(n){return this.hasClass(n)?this.removeClass(n):this.addClass(n)}v("Dom",{classes:Us,hasClass:Xs,addClass:Gs,removeClass:Ks,toggleClass:Js});function Qs(n,t){const e={};if(arguments.length===0)return this.node.style.cssText.split(/\s*;\s*/).filter(function(s){return!!s.length}).forEach(function(s){const i=s.split(/\s*:\s*/);e[i[0]]=i[1]}),e;if(arguments.length<2){if(Array.isArray(n)){for(const s of n){const i=s;e[s]=this.node.style.getPropertyValue(i)}return e}if(typeof n=="string")return this.node.style.getPropertyValue(n);if(typeof n=="object")for(const s in n)this.node.style.setProperty(s,n[s]==null||on.test(n[s])?"":n[s])}return arguments.length===2&&this.node.style.setProperty(n,t==null||on.test(t)?"":t),this}function Zs(){return this.css("display","")}function ti(){return this.css("display","none")}function ei(){return this.css("display")!=="none"}v("Dom",{css:Qs,show:Zs,hide:ti,visible:ei});function ni(n,t,e){if(n==null)return this.data(He(Es(this.node.attributes,s=>s.nodeName.indexOf("data-")===0),s=>s.nodeName.slice(5)));if(n instanceof Array){const s={};for(const i of n)s[i]=this.data(i);return s}else if(typeof n=="object")for(t in n)this.data(t,n[t]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+n))}catch{return this.attr("data-"+n)}else this.attr("data-"+n,t===null?null:e===!0||typeof t=="string"||typeof t=="number"?t:JSON.stringify(t));return this}v("Dom",{data:ni});function si(n,t){if(typeof arguments[0]=="object")for(const e in n)this.remember(e,n[e]);else{if(arguments.length===1)return this.memory()[n];this.memory()[n]=t}return this}function ii(){if(arguments.length===0)this._memory={};else for(let n=arguments.length-1;n>=0;n--)delete this.memory()[arguments[n]];return this}function ri(){return this._memory=this._memory||{}}v("Dom",{remember:si,forget:ii,memory:ri});function oi(n){return n.length===4?["#",n.substring(1,2),n.substring(1,2),n.substring(2,3),n.substring(2,3),n.substring(3,4),n.substring(3,4)].join(""):n}function ai(n){const t=Math.round(n),s=Math.max(0,Math.min(255,t)).toString(16);return s.length===1?"0"+s:s}function Et(n,t){for(let e=t.length;e--;)if(n[t[e]]==null)return!1;return!0}function li(n,t){const e=Et(n,"rgb")?{_a:n.r,_b:n.g,_c:n.b,_d:0,space:"rgb"}:Et(n,"xyz")?{_a:n.x,_b:n.y,_c:n.z,_d:0,space:"xyz"}:Et(n,"hsl")?{_a:n.h,_b:n.s,_c:n.l,_d:0,space:"hsl"}:Et(n,"lab")?{_a:n.l,_b:n.a,_c:n.b,_d:0,space:"lab"}:Et(n,"lch")?{_a:n.l,_b:n.c,_c:n.h,_d:0,space:"lch"}:Et(n,"cmyk")?{_a:n.c,_b:n.m,_c:n.y,_d:n.k,space:"cmyk"}:{_a:0,_b:0,_c:0,space:"rgb"};return e.space=t||e.space,e}function ui(n){return n==="lab"||n==="xyz"||n==="lch"}function me(n,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+(t-n)*6*e:e<1/2?t:e<2/3?n+(t-n)*(2/3-e)*6:n}class k{constructor(...t){this.init(...t)}static isColor(t){return t&&(t instanceof k||this.isRgb(t)||this.test(t))}static isRgb(t){return t&&typeof t.r=="number"&&typeof t.g=="number"&&typeof t.b=="number"}static random(t="vibrant",e){const{random:s,round:i,sin:r,PI:o}=Math;if(t==="vibrant"){const a=24*s()+57,l=38*s()+45,u=360*s();return new k(a,l,u,"lch")}else if(t==="sine"){e=e??s();const a=i(80*r(2*o*e/.5+.01)+150),l=i(50*r(2*o*e/.5+4.6)+200),u=i(100*r(2*o*e/.5+2.3)+150);return new k(a,l,u)}else if(t==="pastel"){const a=8*s()+86,l=17*s()+9,u=360*s();return new k(a,l,u,"lch")}else if(t==="dark"){const a=10+10*s(),l=50*s()+86,u=360*s();return new k(a,l,u,"lch")}else if(t==="rgb"){const a=255*s(),l=255*s(),u=255*s();return new k(a,l,u)}else if(t==="lab"){const a=100*s(),l=256*s()-128,u=256*s()-128;return new k(a,l,u,"lab")}else if(t==="grey"){const a=255*s();return new k(a,a,a)}else throw new Error("Unsupported random color mode")}static test(t){return typeof t=="string"&&(sn.test(t)||rn.test(t))}cmyk(){const{_a:t,_b:e,_c:s}=this.rgb(),[i,r,o]=[t,e,s].map(f=>f/255),a=Math.min(1-i,1-r,1-o);if(a===1)return new k(0,0,0,1,"cmyk");const l=(1-i-a)/(1-a),u=(1-r-a)/(1-a),h=(1-o-a)/(1-a);return new k(l,u,h,a,"cmyk")}hsl(){const{_a:t,_b:e,_c:s}=this.rgb(),[i,r,o]=[t,e,s].map(p=>p/255),a=Math.max(i,r,o),l=Math.min(i,r,o),u=(a+l)/2,h=a===l,c=a-l,f=h?0:u>.5?c/(2-a-l):c/(a+l),d=h?0:a===i?((r-o)/c+(r<o?6:0))/6:a===r?((o-i)/c+2)/6:a===o?((i-r)/c+4)/6:0;return new k(360*d,100*f,100*u,"hsl")}init(t=0,e=0,s=0,i=0,r="rgb"){if(t=t||0,this.space)for(const c in this.space)delete this[this.space[c]];if(typeof t=="number")r=typeof i=="string"?i:r,i=typeof i=="string"?0:i,Object.assign(this,{_a:t,_b:e,_c:s,_d:i,space:r});else if(t instanceof Array)this.space=e||(typeof t[3]=="string"?t[3]:t[4])||"rgb",Object.assign(this,{_a:t[0],_b:t[1],_c:t[2],_d:t[3]||0});else if(t instanceof Object){const c=li(t,e);Object.assign(this,c)}else if(typeof t=="string")if(rn.test(t)){const c=t.replace(Ys,""),[f,d,g]=$s.exec(c).slice(1,4).map(p=>parseInt(p));Object.assign(this,{_a:f,_b:d,_c:g,_d:0,space:"rgb"})}else if(sn.test(t)){const c=p=>parseInt(p,16),[,f,d,g]=Bs.exec(oi(t)).map(c);Object.assign(this,{_a:f,_b:d,_c:g,_d:0,space:"rgb"})}else throw Error("Unsupported string format, can't construct Color");const{_a:o,_b:a,_c:l,_d:u}=this,h=this.space==="rgb"?{r:o,g:a,b:l}:this.space==="xyz"?{x:o,y:a,z:l}:this.space==="hsl"?{h:o,s:a,l}:this.space==="lab"?{l:o,a,b:l}:this.space==="lch"?{l:o,c:a,h:l}:this.space==="cmyk"?{c:o,m:a,y:l,k:u}:{};Object.assign(this,h)}lab(){const{x:t,y:e,z:s}=this.xyz(),i=116*e-16,r=500*(t-e),o=200*(e-s);return new k(i,r,o,"lab")}lch(){const{l:t,a:e,b:s}=this.lab(),i=Math.sqrt(e**2+s**2);let r=180*Math.atan2(s,e)/Math.PI;return r<0&&(r*=-1,r=360-r),new k(t,i,r,"lch")}rgb(){if(this.space==="rgb")return this;if(ui(this.space)){let{x:t,y:e,z:s}=this;if(this.space==="lab"||this.space==="lch"){let{l:d,a:g,b:p}=this;if(this.space==="lch"){const{c:G,h:st}=this,lt=Math.PI/180;g=G*Math.cos(lt*st),p=G*Math.sin(lt*st)}const w=(d+16)/116,A=g/500+w,z=w-p/200,O=16/116,Y=.008856,P=7.787;t=.95047*(A**3>Y?A**3:(A-O)/P),e=1*(w**3>Y?w**3:(w-O)/P),s=1.08883*(z**3>Y?z**3:(z-O)/P)}const i=t*3.2406+e*-1.5372+s*-.4986,r=t*-.9689+e*1.8758+s*.0415,o=t*.0557+e*-.204+s*1.057,a=Math.pow,l=.0031308,u=i>l?1.055*a(i,1/2.4)-.055:12.92*i,h=r>l?1.055*a(r,1/2.4)-.055:12.92*r,c=o>l?1.055*a(o,1/2.4)-.055:12.92*o;return new k(255*u,255*h,255*c)}else if(this.space==="hsl"){let{h:t,s:e,l:s}=this;if(t/=360,e/=100,s/=100,e===0)return s*=255,new k(s,s,s);const i=s<.5?s*(1+e):s+e-s*e,r=2*s-i,o=255*me(r,i,t+1/3),a=255*me(r,i,t),l=255*me(r,i,t-1/3);return new k(o,a,l)}else if(this.space==="cmyk"){const{c:t,m:e,y:s,k:i}=this,r=255*(1-Math.min(1,t*(1-i)+i)),o=255*(1-Math.min(1,e*(1-i)+i)),a=255*(1-Math.min(1,s*(1-i)+i));return new k(r,o,a)}else return this}toArray(){const{_a:t,_b:e,_c:s,_d:i,space:r}=this;return[t,e,s,i,r]}toHex(){const[t,e,s]=this._clamped().map(ai);return`#${t}${e}${s}`}toRgb(){const[t,e,s]=this._clamped();return`rgb(${t},${e},${s})`}toString(){return this.toHex()}xyz(){const{_a:t,_b:e,_c:s}=this.rgb(),[i,r,o]=[t,e,s].map(A=>A/255),a=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,l=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,u=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92,h=(a*.4124+l*.3576+u*.1805)/.95047,c=(a*.2126+l*.7152+u*.0722)/1,f=(a*.0193+l*.1192+u*.9505)/1.08883,d=h>.008856?Math.pow(h,1/3):7.787*h+16/116,g=c>.008856?Math.pow(c,1/3):7.787*c+16/116,p=f>.008856?Math.pow(f,1/3):7.787*f+16/116;return new k(d,g,p,"xyz")}_clamped(){const{_a:t,_b:e,_c:s}=this.rgb(),{max:i,min:r,round:o}=Math,a=l=>i(0,r(o(l),255));return[t,e,s].map(a)}}class N{constructor(...t){this.init(...t)}clone(){return new N(this)}init(t,e){const s={x:0,y:0},i=Array.isArray(t)?{x:t[0],y:t[1]}:typeof t=="object"?{x:t.x,y:t.y}:{x:t,y:e};return this.x=i.x==null?s.x:i.x,this.y=i.y==null?s.y:i.y,this}toArray(){return[this.x,this.y]}transform(t){return this.clone().transformO(t)}transformO(t){b.isMatrixLike(t)||(t=new b(t));const{x:e,y:s}=this;return this.x=t.a*e+t.c*s+t.e,this.y=t.b*e+t.d*s+t.f,this}}function hi(n,t){return new N(n,t).transformO(this.screenCTM().inverseO())}function Tt(n,t,e){return Math.abs(t-n)<1e-6}class b{constructor(...t){this.init(...t)}static formatTransforms(t){const e=t.flip==="both"||t.flip===!0,s=t.flip&&(e||t.flip==="x")?-1:1,i=t.flip&&(e||t.flip==="y")?-1:1,r=t.skew&&t.skew.length?t.skew[0]:isFinite(t.skew)?t.skew:isFinite(t.skewX)?t.skewX:0,o=t.skew&&t.skew.length?t.skew[1]:isFinite(t.skew)?t.skew:isFinite(t.skewY)?t.skewY:0,a=t.scale&&t.scale.length?t.scale[0]*s:isFinite(t.scale)?t.scale*s:isFinite(t.scaleX)?t.scaleX*s:s,l=t.scale&&t.scale.length?t.scale[1]*i:isFinite(t.scale)?t.scale*i:isFinite(t.scaleY)?t.scaleY*i:i,u=t.shear||0,h=t.rotate||t.theta||0,c=new N(t.origin||t.around||t.ox||t.originX,t.oy||t.originY),f=c.x,d=c.y,g=new N(t.position||t.px||t.positionX||NaN,t.py||t.positionY||NaN),p=g.x,w=g.y,A=new N(t.translate||t.tx||t.translateX,t.ty||t.translateY),z=A.x,O=A.y,Y=new N(t.relative||t.rx||t.relativeX,t.ry||t.relativeY),P=Y.x,G=Y.y;return{scaleX:a,scaleY:l,skewX:r,skewY:o,shear:u,theta:h,rx:P,ry:G,tx:z,ty:O,ox:f,oy:d,px:p,py:w}}static fromArray(t){return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}}static isMatrixLike(t){return t.a!=null||t.b!=null||t.c!=null||t.d!=null||t.e!=null||t.f!=null}static matrixMultiply(t,e,s){const i=t.a*e.a+t.c*e.b,r=t.b*e.a+t.d*e.b,o=t.a*e.c+t.c*e.d,a=t.b*e.c+t.d*e.d,l=t.e+t.a*e.e+t.c*e.f,u=t.f+t.b*e.e+t.d*e.f;return s.a=i,s.b=r,s.c=o,s.d=a,s.e=l,s.f=u,s}around(t,e,s){return this.clone().aroundO(t,e,s)}aroundO(t,e,s){const i=t||0,r=e||0;return this.translateO(-i,-r).lmultiplyO(s).translateO(i,r)}clone(){return new b(this)}decompose(t=0,e=0){const s=this.a,i=this.b,r=this.c,o=this.d,a=this.e,l=this.f,u=s*o-i*r,h=u>0?1:-1,c=h*Math.sqrt(s*s+i*i),f=Math.atan2(h*i,h*s),d=180/Math.PI*f,g=Math.cos(f),p=Math.sin(f),w=(s*r+i*o)/u,A=r*c/(w*s-i)||o*c/(w*i+s),z=a-t+t*g*c+e*(w*g*c-p*A),O=l-e+t*p*c+e*(w*p*c+g*A);return{scaleX:c,scaleY:A,shear:w,rotate:d,translateX:z,translateY:O,originX:t,originY:e,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}equals(t){if(t===this)return!0;const e=new b(t);return Tt(this.a,e.a)&&Tt(this.b,e.b)&&Tt(this.c,e.c)&&Tt(this.d,e.d)&&Tt(this.e,e.e)&&Tt(this.f,e.f)}flip(t,e){return this.clone().flipO(t,e)}flipO(t,e){return t==="x"?this.scaleO(-1,1,e,0):t==="y"?this.scaleO(1,-1,0,e):this.scaleO(-1,-1,t,e||t)}init(t){const e=b.fromArray([1,0,0,1,0,0]);return t=t instanceof U?t.matrixify():typeof t=="string"?b.fromArray(t.split(at).map(parseFloat)):Array.isArray(t)?b.fromArray(t):typeof t=="object"&&b.isMatrixLike(t)?t:typeof t=="object"?new b().transform(t):arguments.length===6?b.fromArray([].slice.call(arguments)):e,this.a=t.a!=null?t.a:e.a,this.b=t.b!=null?t.b:e.b,this.c=t.c!=null?t.c:e.c,this.d=t.d!=null?t.d:e.d,this.e=t.e!=null?t.e:e.e,this.f=t.f!=null?t.f:e.f,this}inverse(){return this.clone().inverseO()}inverseO(){const t=this.a,e=this.b,s=this.c,i=this.d,r=this.e,o=this.f,a=t*i-e*s;if(!a)throw new Error("Cannot invert "+this);const l=i/a,u=-e/a,h=-s/a,c=t/a,f=-(l*r+h*o),d=-(u*r+c*o);return this.a=l,this.b=u,this.c=h,this.d=c,this.e=f,this.f=d,this}lmultiply(t){return this.clone().lmultiplyO(t)}lmultiplyO(t){const e=this,s=t instanceof b?t:new b(t);return b.matrixMultiply(s,e,this)}multiply(t){return this.clone().multiplyO(t)}multiplyO(t){const e=this,s=t instanceof b?t:new b(t);return b.matrixMultiply(e,s,this)}rotate(t,e,s){return this.clone().rotateO(t,e,s)}rotateO(t,e=0,s=0){t=de(t);const i=Math.cos(t),r=Math.sin(t),{a:o,b:a,c:l,d:u,e:h,f:c}=this;return this.a=o*i-a*r,this.b=a*i+o*r,this.c=l*i-u*r,this.d=u*i+l*r,this.e=h*i-c*r+s*r-e*i+e,this.f=c*i+h*r-e*r-s*i+s,this}scale(){return this.clone().scaleO(...arguments)}scaleO(t,e=t,s=0,i=0){arguments.length===3&&(i=s,s=e,e=t);const{a:r,b:o,c:a,d:l,e:u,f:h}=this;return this.a=r*t,this.b=o*e,this.c=a*t,this.d=l*e,this.e=u*t-s*t+s,this.f=h*e-i*e+i,this}shear(t,e,s){return this.clone().shearO(t,e,s)}shearO(t,e=0,s=0){const{a:i,b:r,c:o,d:a,e:l,f:u}=this;return this.a=i+r*t,this.c=o+a*t,this.e=l+u*t-s*t,this}skew(){return this.clone().skewO(...arguments)}skewO(t,e=t,s=0,i=0){arguments.length===3&&(i=s,s=e,e=t),t=de(t),e=de(e);const r=Math.tan(t),o=Math.tan(e),{a,b:l,c:u,d:h,e:c,f}=this;return this.a=a+l*r,this.b=l+a*o,this.c=u+h*r,this.d=h+u*o,this.e=c+f*r-i*r,this.f=f+c*o-s*o,this}skewX(t,e,s){return this.skew(t,0,e,s)}skewY(t,e,s){return this.skew(0,t,e,s)}toArray(){return[this.a,this.b,this.c,this.d,this.e,this.f]}toString(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}transform(t){if(b.isMatrixLike(t))return new b(t).multiplyO(this);const e=b.formatTransforms(t),s=this,{x:i,y:r}=new N(e.ox,e.oy).transform(s),o=new b().translateO(e.rx,e.ry).lmultiplyO(s).translateO(-i,-r).scaleO(e.scaleX,e.scaleY).skewO(e.skewX,e.skewY).shearO(e.shear).rotateO(e.theta).translateO(i,r);if(isFinite(e.px)||isFinite(e.py)){const a=new N(i,r).transform(o),l=isFinite(e.px)?e.px-a.x:0,u=isFinite(e.py)?e.py-a.y:0;o.translateO(l,u)}return o.translateO(e.tx,e.ty),o}translate(t,e){return this.clone().translateO(t,e)}translateO(t,e){return this.e+=t||0,this.f+=e||0,this}valueOf(){return{a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}}function ci(){return new b(this.node.getCTM())}function di(){try{if(typeof this.isRoot=="function"&&!this.isRoot()){const n=this.rect(1,1),t=n.node.getScreenCTM();return n.remove(),new b(t)}return new b(this.node.getScreenCTM())}catch{return console.warn(`Cannot get CTM from SVG node ${this.node.nodeName}. Is the element rendered?`),new b}}S(b,"Matrix");function ht(){if(!ht.nodes){const n=j().size(2,0);n.node.style.cssText=["opacity: 0","position: absolute","left: -100%","top: -100%","overflow: hidden"].join(";"),n.attr("focusable","false"),n.attr("aria-hidden","true");const t=n.path().node;ht.nodes={svg:n,path:t}}if(!ht.nodes.svg.node.parentNode){const n=T.document.body||T.document.documentElement;ht.nodes.svg.addTo(n)}return ht.nodes}function Dn(n){return!n.width&&!n.height&&!n.x&&!n.y}function fi(n){return n===T.document||(T.document.documentElement.contains||function(t){for(;t.parentNode;)t=t.parentNode;return t===T.document}).call(T.document.documentElement,n)}class H{constructor(...t){this.init(...t)}addOffset(){return this.x+=T.window.pageXOffset,this.y+=T.window.pageYOffset,new H(this)}init(t){const e=[0,0,0,0];return t=typeof t=="string"?t.split(at).map(parseFloat):Array.isArray(t)?t:typeof t=="object"?[t.left!=null?t.left:t.x,t.top!=null?t.top:t.y,t.width,t.height]:arguments.length===4?[].slice.call(arguments):e,this.x=t[0]||0,this.y=t[1]||0,this.width=this.w=t[2]||0,this.height=this.h=t[3]||0,this.x2=this.x+this.w,this.y2=this.y+this.h,this.cx=this.x+this.w/2,this.cy=this.y+this.h/2,this}isNulled(){return Dn(this)}merge(t){const e=Math.min(this.x,t.x),s=Math.min(this.y,t.y),i=Math.max(this.x+this.width,t.x+t.width)-e,r=Math.max(this.y+this.height,t.y+t.height)-s;return new H(e,s,i,r)}toArray(){return[this.x,this.y,this.width,this.height]}toString(){return this.x+" "+this.y+" "+this.width+" "+this.height}transform(t){t instanceof b||(t=new b(t));let e=1/0,s=-1/0,i=1/0,r=-1/0;return[new N(this.x,this.y),new N(this.x2,this.y),new N(this.x,this.y2),new N(this.x2,this.y2)].forEach(function(a){a=a.transform(t),e=Math.min(e,a.x),s=Math.max(s,a.x),i=Math.min(i,a.y),r=Math.max(r,a.y)}),new H(e,i,s-e,r-i)}}function Cn(n,t,e){let s;try{if(s=t(n.node),Dn(s)&&!fi(n.node))throw new Error("Element not in the dom")}catch{s=e(n)}return s}function pi(){const e=Cn(this,i=>i.getBBox(),i=>{try{const r=i.clone().addTo(ht().svg).show(),o=r.node.getBBox();return r.remove(),o}catch(r){throw new Error(`Getting bbox of element "${i.node.nodeName}" is not possible: ${r.toString()}`)}});return new H(e)}function mi(n){const s=Cn(this,r=>r.getBoundingClientRect(),r=>{throw new Error(`Getting rbox of element "${r.node.nodeName}" is not possible`)}),i=new H(s);return n?i.transform(n.screenCTM().inverseO()):i.addOffset()}function gi(n,t){const e=this.bbox();return n>e.x&&t>e.y&&n<e.x+e.width&&t<e.y+e.height}v({viewbox:{viewbox(n,t,e,s){return n==null?new H(this.attr("viewBox")):this.attr("viewBox",new H(n,t,e,s))},zoom(n,t){let{width:e,height:s}=this.attr(["width","height"]);if((!e&&!s||typeof e=="string"||typeof s=="string")&&(e=this.node.clientWidth,s=this.node.clientHeight),!e||!s)throw new Error("Impossible to get absolute width and height. Please provide an absolute width and height attribute on the zooming element");const i=this.viewbox(),r=e/i.width,o=s/i.height,a=Math.min(r,o);if(n==null)return a;let l=a/n;l===1/0&&(l=Number.MAX_SAFE_INTEGER/100),t=t||new N(e/2/r+i.x,s/2/o+i.y);const u=new H(i).transform(new b({scale:l,origin:t}));return this.viewbox(u)}}});S(H,"Box");class bt extends Array{constructor(t=[],...e){if(super(t,...e),typeof t=="number")return this;this.length=0,this.push(...t)}}x([bt],{each(n,...t){return typeof n=="function"?this.map((e,s,i)=>n.call(e,e,s,i)):this.map(e=>e[n](...t))},toArray(){return Array.prototype.concat.apply([],this)}});const yi=["toArray","constructor","each"];bt.extend=function(n){n=n.reduce((t,e)=>(yi.includes(e)||e[0]==="_"||(e in Array.prototype&&(t["$"+e]=Array.prototype[e]),t[e]=function(...s){return this.each(e,...s)}),t),{}),x([bt],n)};function Ct(n,t){return new bt(He((t||T.document).querySelectorAll(n),function(e){return Z(e)}))}function bi(n){return Ct(n,this.node)}function wi(n){return Z(this.node.querySelector(n))}let _i=0;const kn={};function Mn(n){let t=n.getEventHolder();return t===T.window&&(t=kn),t.events||(t.events={}),t.events}function $e(n){return n.getEventTarget()}function xi(n){let t=n.getEventHolder();t===T.window&&(t=kn),t.events&&(t.events={})}function rt(n,t,e,s,i){const r=e.bind(s||n),o=j(n),a=Mn(o),l=$e(o);t=Array.isArray(t)?t:t.split(at),e._svgjsListenerId||(e._svgjsListenerId=++_i),t.forEach(function(u){const h=u.split(".")[0],c=u.split(".")[1]||"*";a[h]=a[h]||{},a[h][c]=a[h][c]||{},a[h][c][e._svgjsListenerId]=r,l.addEventListener(h,r,i||!1)})}function tt(n,t,e,s){const i=j(n),r=Mn(i),o=$e(i);typeof e=="function"&&(e=e._svgjsListenerId,!e)||(t=Array.isArray(t)?t:(t||"").split(at),t.forEach(function(a){const l=a&&a.split(".")[0],u=a&&a.split(".")[1];let h,c;if(e)r[l]&&r[l][u||"*"]&&(o.removeEventListener(l,r[l][u||"*"][e],s||!1),delete r[l][u||"*"][e]);else if(l&&u){if(r[l]&&r[l][u]){for(c in r[l][u])tt(o,[l,u].join("."),c);delete r[l][u]}}else if(u)for(a in r)for(h in r[a])u===h&&tt(o,[a,u].join("."));else if(l){if(r[l]){for(h in r[l])tt(o,[l,h].join("."));delete r[l]}}else{for(a in r)tt(o,a);xi(i)}}))}function vi(n,t,e,s){const i=$e(n);return t instanceof T.window.Event||(t=new T.window.CustomEvent(t,{detail:e,cancelable:!0,...s})),i.dispatchEvent(t),t}class Ut extends Ie{addEventListener(){}dispatch(t,e,s){return vi(this,t,e,s)}dispatchEvent(t){const e=this.getEventHolder().events;if(!e)return!0;const s=e[t.type];for(const i in s)for(const r in s[i])s[i][r](t);return!t.defaultPrevented}fire(t,e,s){return this.dispatch(t,e,s),this}getEventHolder(){return this}getEventTarget(){return this}off(t,e,s){return tt(this,t,e,s),this}on(t,e,s,i){return rt(this,t,e,s,i),this}removeEventListener(){}}S(Ut,"EventTarget");function ln(){}const Rt={duration:400,ease:">",delay:0},Ei={"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","text-anchor":"start"};class At extends Array{constructor(...t){super(...t),this.init(...t)}clone(){return new this.constructor(this)}init(t){return typeof t=="number"?this:(this.length=0,this.push(...this.parse(t)),this)}parse(t=[]){return t instanceof Array?t:t.trim().split(at).map(parseFloat)}toArray(){return Array.prototype.concat.apply([],this)}toSet(){return new Set(this)}toString(){return this.join(" ")}valueOf(){const t=[];return t.push(...this),t}}class _{constructor(...t){this.init(...t)}convert(t){return new _(this.value,t)}divide(t){return t=new _(t),new _(this/t,this.unit||t.unit)}init(t,e){return e=Array.isArray(t)?t[1]:e,t=Array.isArray(t)?t[0]:t,this.value=0,this.unit=e||"",typeof t=="number"?this.value=isNaN(t)?0:isFinite(t)?t:t<0?-34e37:34e37:typeof t=="string"?(e=t.match(An),e&&(this.value=parseFloat(e[1]),e[5]==="%"?this.value/=100:e[5]==="s"&&(this.value*=1e3),this.unit=e[5])):t instanceof _&&(this.value=t.valueOf(),this.unit=t.unit),this}minus(t){return t=new _(t),new _(this-t,this.unit||t.unit)}plus(t){return t=new _(t),new _(this+t,this.unit||t.unit)}times(t){return t=new _(t),new _(this*t,this.unit||t.unit)}toArray(){return[this.value,this.unit]}toJSON(){return this.toString()}toString(){return(this.unit==="%"?~~(this.value*1e8)/1e6:this.unit==="s"?this.value/1e3:this.value)+this.unit}valueOf(){return this.value}}const Ti=new Set(["fill","stroke","color","bgcolor","stop-color","flood-color","lighting-color"]),Pn=[];function Si(n){Pn.push(n)}function Ai(n,t,e){if(n==null){n={},t=this.node.attributes;for(const s of t)n[s.nodeName]=an.test(s.nodeValue)?parseFloat(s.nodeValue):s.nodeValue;return n}else{if(n instanceof Array)return n.reduce((s,i)=>(s[i]=this.attr(i),s),{});if(typeof n=="object"&&n.constructor===Object)for(t in n)this.attr(t,n[t]);else if(t===null)this.node.removeAttribute(n);else{if(t==null)return t=this.node.getAttribute(n),t==null?Ei[n]:an.test(t)?parseFloat(t):t;t=Pn.reduce((s,i)=>i(n,s,this),t),typeof t=="number"?t=new _(t):Ti.has(n)&&k.isColor(t)?t=new k(t):t.constructor===Array&&(t=new At(t)),n==="leading"?this.leading&&this.leading(t):typeof e=="string"?this.node.setAttributeNS(e,n,t.toString()):this.node.setAttribute(n,t.toString()),this.rebuild&&(n==="font-size"||n==="x")&&this.rebuild()}}return this}class ct extends Ut{constructor(t,e){super(),this.node=t,this.type=t.nodeName,e&&t!==e&&this.attr(e)}add(t,e){return t=j(t),t.removeNamespace&&this.node instanceof T.window.SVGElement&&t.removeNamespace(),e==null?this.node.appendChild(t.node):t.node!==this.node.childNodes[e]&&this.node.insertBefore(t.node,this.node.childNodes[e]),this}addTo(t,e){return j(t).put(this,e)}children(){return new bt(He(this.node.children,function(t){return Z(t)}))}clear(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this}clone(t=!0,e=!0){this.writeDataToDom();let s=this.node.cloneNode(t);return e&&(s=Sn(s)),new this.constructor(s)}each(t,e){const s=this.children();let i,r;for(i=0,r=s.length;i<r;i++)t.apply(s[i],[i,s]),e&&s[i].each(t,e);return this}element(t,e){return this.put(new ct(It(t),e))}first(){return Z(this.node.firstChild)}get(t){return Z(this.node.childNodes[t])}getEventHolder(){return this.node}getEventTarget(){return this.node}has(t){return this.index(t)>=0}html(t,e){return this.xml(t,e,As)}id(t){return typeof t>"u"&&!this.node.id&&(this.node.id=Tn(this.type)),this.attr("id",t)}index(t){return[].slice.call(this.node.childNodes).indexOf(t.node)}last(){return Z(this.node.lastChild)}matches(t){const e=this.node,s=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector||null;return s&&s.call(e,t)}parent(t){let e=this;if(!e.node.parentNode)return null;if(e=Z(e.node.parentNode),!t)return e;do if(typeof t=="string"?e.matches(t):e instanceof t)return e;while(e=Z(e.node.parentNode));return e}put(t,e){return t=j(t),this.add(t,e),t}putIn(t,e){return j(t).add(this,e)}remove(){return this.parent()&&this.parent().removeElement(this),this}removeElement(t){return this.node.removeChild(t.node),this}replace(t){return t=j(t),this.node.parentNode&&this.node.parentNode.replaceChild(t.node,this.node),t}round(t=2,e=null){const s=10**t,i=this.attr(e);for(const r in i)typeof i[r]=="number"&&(i[r]=Math.round(i[r]*s)/s);return this.attr(i),this}svg(t,e){return this.xml(t,e,Le)}toString(){return this.id()}words(t){return this.node.textContent=t,this}wrap(t){const e=this.parent();if(!e)return this.addTo(t);const s=e.index(this);return e.put(t,s).put(this)}writeDataToDom(){return this.each(function(){this.writeDataToDom()}),this}xml(t,e,s){if(typeof t=="boolean"&&(s=e,e=t,t=null),t==null||typeof t=="function"){e=e??!0,this.writeDataToDom();let a=this;if(t!=null){if(a=Z(a.node.cloneNode(!0)),e){const l=t(a);if(a=l||a,l===!1)return""}a.each(function(){const l=t(this),u=l||this;l===!1?this.remove():l&&this!==u&&this.replace(u)},!0)}return e?a.node.outerHTML:a.node.innerHTML}e=e??!1;const i=It("wrapper",s),r=T.document.createDocumentFragment();i.innerHTML=t;for(let a=i.children.length;a--;)r.appendChild(i.firstElementChild);const o=this.parent();return e?this.replace(r)&&o:this.add(r)}}x(ct,{attr:Ai,find:bi,findOne:wi});S(ct,"Dom");class U extends ct{constructor(t,e){super(t,e),this.dom={},this.node.instance=this,(t.hasAttribute("data-svgjs")||t.hasAttribute("svgjs:data"))&&this.setData(JSON.parse(t.getAttribute("data-svgjs"))??JSON.parse(t.getAttribute("svgjs:data"))??{})}center(t,e){return this.cx(t).cy(e)}cx(t){return t==null?this.x()+this.width()/2:this.x(t-this.width()/2)}cy(t){return t==null?this.y()+this.height()/2:this.y(t-this.height()/2)}defs(){const t=this.root();return t&&t.defs()}dmove(t,e){return this.dx(t).dy(e)}dx(t=0){return this.x(new _(t).plus(this.x()))}dy(t=0){return this.y(new _(t).plus(this.y()))}getEventHolder(){return this}height(t){return this.attr("height",t)}move(t,e){return this.x(t).y(e)}parents(t=this.root()){const e=typeof t=="string";e||(t=j(t));const s=new bt;let i=this;for(;(i=i.parent())&&i.node!==T.document&&i.nodeName!=="#document-fragment"&&(s.push(i),!(!e&&i.node===t.node||e&&i.matches(t)));)if(i.node===this.root().node)return null;return s}reference(t){if(t=this.attr(t),!t)return null;const e=(t+"").match(js);return e?j(e[1]):null}root(){const t=this.parent(Ds(Ve));return t&&t.root()}setData(t){return this.dom=t,this}size(t,e){const s=Dt(this,t,e);return this.width(new _(s.width)).height(new _(s.height))}width(t){return this.attr("width",t)}writeDataToDom(){return En(this,this.dom),super.writeDataToDom()}x(t){return this.attr("x",t)}y(t){return this.attr("y",t)}}x(U,{bbox:pi,rbox:mi,inside:gi,point:hi,ctm:ci,screenCTM:di});S(U,"Element");const Pt={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(n,t){return t==="color"?n:n+"-"+t}};["fill","stroke"].forEach(function(n){const t={};let e;t[n]=function(s){if(typeof s>"u")return this.attr(n);if(typeof s=="string"||s instanceof k||k.isRgb(s)||s instanceof U)this.attr(n,s);else for(e=Pt[n].length-1;e>=0;e--)s[Pt[n][e]]!=null&&this.attr(Pt.prefix(n,Pt[n][e]),s[Pt[n][e]]);return this},v(["Element","Runner"],t)});v(["Element","Runner"],{matrix:function(n,t,e,s,i,r){return n==null?new b(this):this.attr("transform",new b(n,t,e,s,i,r))},rotate:function(n,t,e){return this.transform({rotate:n,ox:t,oy:e},!0)},skew:function(n,t,e,s){return arguments.length===1||arguments.length===3?this.transform({skew:n,ox:t,oy:e},!0):this.transform({skew:[n,t],ox:e,oy:s},!0)},shear:function(n,t,e){return this.transform({shear:n,ox:t,oy:e},!0)},scale:function(n,t,e,s){return arguments.length===1||arguments.length===3?this.transform({scale:n,ox:t,oy:e},!0):this.transform({scale:[n,t],ox:e,oy:s},!0)},translate:function(n,t){return this.transform({translate:[n,t]},!0)},relative:function(n,t){return this.transform({relative:[n,t]},!0)},flip:function(n="both",t="center"){return"xybothtrue".indexOf(n)===-1&&(t=n,n="both"),this.transform({flip:n,origin:t},!0)},opacity:function(n){return this.attr("opacity",n)}});v("radius",{radius:function(n,t=n){return(this._element||this).type==="radialGradient"?this.attr("r",new _(n)):this.rx(n).ry(t)}});v("Path",{length:function(){return this.node.getTotalLength()},pointAt:function(n){return new N(this.node.getPointAtLength(n))}});v(["Element","Runner"],{font:function(n,t){if(typeof n=="object"){for(t in n)this.font(t,n[t]);return this}return n==="leading"?this.leading(t):n==="anchor"?this.attr("text-anchor",t):n==="size"||n==="family"||n==="weight"||n==="stretch"||n==="variant"||n==="style"?this.attr("font-"+n,t):this.attr(n,t)}});const Di=["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel","contextmenu","wheel","pointerdown","pointermove","pointerup","pointerleave","pointercancel"].reduce(function(n,t){const e=function(s){return s===null?this.off(t):this.on(t,s),this};return n[t]=e,n},{});v("Element",Di);function Ci(){return this.attr("transform",null)}function ki(){return(this.attr("transform")||"").split(Ws).slice(0,-1).map(function(t){const e=t.trim().split("(");return[e[0],e[1].split(at).map(function(s){return parseFloat(s)})]}).reverse().reduce(function(t,e){return e[0]==="matrix"?t.lmultiply(b.fromArray(e[1])):t[e[0]].apply(t,e[1])},new b)}function Mi(n,t){if(this===n)return this;if(xe(this.node))return this.addTo(n,t);const e=this.screenCTM(),s=n.screenCTM().inverse();return this.addTo(n,t).untransform().transform(s.multiply(e)),this}function Pi(n){return this.toParent(this.root(),n)}function Fi(n,t){if(n==null||typeof n=="string"){const i=new b(this).decompose();return n==null?i:i[n]}b.isMatrixLike(n)||(n={...n,origin:_e(n,this)});const e=t===!0?this:t||!1,s=new b(e).transform(n);return this.attr("transform",s)}v("Element",{untransform:Ci,matrixify:ki,toParent:Mi,toRoot:Pi,transform:Fi});class X extends U{flatten(){return this.each(function(){if(this instanceof X)return this.flatten().ungroup()}),this}ungroup(t=this.parent(),e=t.index(this)){return e=e===-1?t.children().length:e,this.each(function(s,i){return i[i.length-s-1].toParent(t,e)}),this.remove()}}S(X,"Container");class je extends X{constructor(t,e=t){super(R("defs",t),e)}flatten(){return this}ungroup(){return this}}S(je,"Defs");class Q extends U{}S(Q,"Shape");function We(n){return this.attr("rx",n)}function Ye(n){return this.attr("ry",n)}function Fn(n){return n==null?this.cx()-this.rx():this.cx(n+this.rx())}function Rn(n){return n==null?this.cy()-this.ry():this.cy(n+this.ry())}function Nn(n){return this.attr("cx",n)}function zn(n){return this.attr("cy",n)}function On(n){return n==null?this.rx()*2:this.rx(new _(n).divide(2))}function Hn(n){return n==null?this.ry()*2:this.ry(new _(n).divide(2))}const Ri=Object.freeze(Object.defineProperty({__proto__:null,cx:Nn,cy:zn,height:Hn,rx:We,ry:Ye,width:On,x:Fn,y:Rn},Symbol.toStringTag,{value:"Module"}));class ae extends Q{constructor(t,e=t){super(R("ellipse",t),e)}size(t,e){const s=Dt(this,t,e);return this.rx(new _(s.width).divide(2)).ry(new _(s.height).divide(2))}}x(ae,Ri);v("Container",{ellipse:F(function(n=0,t=n){return this.put(new ae).size(n,t).move(0,0)})});S(ae,"Ellipse");class Ln extends ct{constructor(t=T.document.createDocumentFragment()){super(t)}xml(t,e,s){if(typeof t=="boolean"&&(s=e,e=t,t=null),t==null||typeof t=="function"){const i=new ct(It("wrapper",s));return i.add(this.node.cloneNode(!0)),i.xml(!1,s)}return super.xml(t,!1,s)}}S(Ln,"Fragment");function In(n,t){return(this._element||this).type==="radialGradient"?this.attr({fx:new _(n),fy:new _(t)}):this.attr({x1:new _(n),y1:new _(t)})}function Vn(n,t){return(this._element||this).type==="radialGradient"?this.attr({cx:new _(n),cy:new _(t)}):this.attr({x2:new _(n),y2:new _(t)})}const Ni=Object.freeze(Object.defineProperty({__proto__:null,from:In,to:Vn},Symbol.toStringTag,{value:"Module"}));class Xt extends X{constructor(t,e){super(R(t+"Gradient",typeof t=="string"?null:t),e)}attr(t,e,s){return t==="transform"&&(t="gradientTransform"),super.attr(t,e,s)}bbox(){return new H}targets(){return Ct("svg [fill*="+this.id()+"]")}toString(){return this.url()}update(t){return this.clear(),typeof t=="function"&&t.call(this,this),this}url(){return"url(#"+this.id()+")"}}x(Xt,Ni);v({Container:{gradient(...n){return this.defs().gradient(...n)}},Defs:{gradient:F(function(n,t){return this.put(new Xt(n)).update(t)})}});S(Xt,"Gradient");class Vt extends X{constructor(t,e=t){super(R("pattern",t),e)}attr(t,e,s){return t==="transform"&&(t="patternTransform"),super.attr(t,e,s)}bbox(){return new H}targets(){return Ct("svg [fill*="+this.id()+"]")}toString(){return this.url()}update(t){return this.clear(),typeof t=="function"&&t.call(this,this),this}url(){return"url(#"+this.id()+")"}}v({Container:{pattern(...n){return this.defs().pattern(...n)}},Defs:{pattern:F(function(n,t,e){return this.put(new Vt).update(e).attr({x:0,y:0,width:n,height:t,patternUnits:"userSpaceOnUse"})})}});S(Vt,"Pattern");class le extends Q{constructor(t,e=t){super(R("image",t),e)}load(t,e){if(!t)return this;const s=new T.window.Image;return rt(s,"load",function(i){const r=this.parent(Vt);this.width()===0&&this.height()===0&&this.size(s.width,s.height),r instanceof Vt&&r.width()===0&&r.height()===0&&r.size(this.width(),this.height()),typeof e=="function"&&e.call(this,i)},this),rt(s,"load error",function(){tt(s)}),this.attr("href",s.src=t,Yt)}}Si(function(n,t,e){return(n==="fill"||n==="stroke")&&qs.test(t)&&(t=e.root().defs().image(t)),t instanceof le&&(t=e.root().defs().pattern(0,0,s=>{s.add(t)})),t});v({Container:{image:F(function(n,t){return this.put(new le).size(0,0).load(n,t)})}});S(le,"Image");class dt extends At{bbox(){let t=-1/0,e=-1/0,s=1/0,i=1/0;return this.forEach(function(r){t=Math.max(r[0],t),e=Math.max(r[1],e),s=Math.min(r[0],s),i=Math.min(r[1],i)}),new H(s,i,t-s,e-i)}move(t,e){const s=this.bbox();if(t-=s.x,e-=s.y,!isNaN(t)&&!isNaN(e))for(let i=this.length-1;i>=0;i--)this[i]=[this[i][0]+t,this[i][1]+e];return this}parse(t=[0,0]){const e=[];t instanceof Array?t=Array.prototype.concat.apply([],t):t=t.trim().split(at).map(parseFloat),t.length%2!==0&&t.pop();for(let s=0,i=t.length;s<i;s=s+2)e.push([t[s],t[s+1]]);return e}size(t,e){let s;const i=this.bbox();for(s=this.length-1;s>=0;s--)i.width&&(this[s][0]=(this[s][0]-i.x)*t/i.width+i.x),i.height&&(this[s][1]=(this[s][1]-i.y)*e/i.height+i.y);return this}toLine(){return{x1:this[0][0],y1:this[0][1],x2:this[1][0],y2:this[1][1]}}toString(){const t=[];for(let e=0,s=this.length;e<s;e++)t.push(this[e].join(","));return t.join(" ")}transform(t){return this.clone().transformO(t)}transformO(t){b.isMatrixLike(t)||(t=new b(t));for(let e=this.length;e--;){const[s,i]=this[e];this[e][0]=t.a*s+t.c*i+t.e,this[e][1]=t.b*s+t.d*i+t.f}return this}}const zi=dt;function Oi(n){return n==null?this.bbox().x:this.move(n,this.bbox().y)}function Hi(n){return n==null?this.bbox().y:this.move(this.bbox().x,n)}function Li(n){const t=this.bbox();return n==null?t.width:this.size(n,t.height)}function Ii(n){const t=this.bbox();return n==null?t.height:this.size(t.width,n)}const qe=Object.freeze(Object.defineProperty({__proto__:null,MorphArray:zi,height:Ii,width:Li,x:Oi,y:Hi},Symbol.toStringTag,{value:"Module"}));class wt extends Q{constructor(t,e=t){super(R("line",t),e)}array(){return new dt([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])}move(t,e){return this.attr(this.array().move(t,e).toLine())}plot(t,e,s,i){return t==null?this.array():(typeof e<"u"?t={x1:t,y1:e,x2:s,y2:i}:t=new dt(t).toLine(),this.attr(t))}size(t,e){const s=Dt(this,t,e);return this.attr(this.array().size(s.width,s.height).toLine())}}x(wt,qe);v({Container:{line:F(function(...n){return wt.prototype.plot.apply(this.put(new wt),n[0]!=null?n:[0,0,0,0])})}});S(wt,"Line");class te extends X{constructor(t,e=t){super(R("marker",t),e)}height(t){return this.attr("markerHeight",t)}orient(t){return this.attr("orient",t)}ref(t,e){return this.attr("refX",t).attr("refY",e)}toString(){return"url(#"+this.id()+")"}update(t){return this.clear(),typeof t=="function"&&t.call(this,this),this}width(t){return this.attr("markerWidth",t)}}v({Container:{marker(...n){return this.defs().marker(...n)}},Defs:{marker:F(function(n,t,e){return this.put(new te).size(n,t).ref(n/2,t/2).viewbox(0,0,n,t).attr("orient","auto").update(e)})},marker:{marker(n,t,e,s){let i=["marker"];return n!=="all"&&i.push(n),i=i.join("-"),n=arguments[1]instanceof te?arguments[1]:this.defs().marker(t,e,s),this.attr(i,n)}}});S(te,"Marker");function St(n,t){return function(e){return e==null?this[n]:(this[n]=e,t&&t.call(this),this)}}const Vi={"-":function(n){return n},"<>":function(n){return-Math.cos(n*Math.PI)/2+.5},">":function(n){return Math.sin(n*Math.PI/2)},"<":function(n){return-Math.cos(n*Math.PI/2)+1},bezier:function(n,t,e,s){return function(i){return i<0?n>0?t/n*i:e>0?s/e*i:0:i>1?e<1?(1-s)/(1-e)*i+(s-e)/(1-e):n<1?(1-t)/(1-n)*i+(t-n)/(1-n):1:3*i*(1-i)**2*t+3*i**2*(1-i)*s+i**3}},steps:function(n,t="end"){t=t.split("-").reverse()[0];let e=n;return t==="none"?--e:t==="both"&&++e,(s,i=!1)=>{let r=Math.floor(s*n);const o=s*r%1===0;return(t==="start"||t==="both")&&++r,i&&o&&--r,s>=0&&r<0&&(r=0),s<=1&&r>e&&(r=e),r/e}}};class Ue{done(){return!1}}class ve extends Ue{constructor(t=Rt.ease){super(),this.ease=Vi[t]||t}step(t,e,s){return typeof t!="number"?s<1?t:e:t+(e-t)*this.ease(s)}}class ee extends Ue{constructor(t){super(),this.stepper=t}done(t){return t.done}step(t,e,s,i){return this.stepper(t,e,s,i)}}function un(){const n=(this._duration||500)/1e3,t=this._overshoot||0,e=1e-10,s=Math.PI,i=Math.log(t/100+e),r=-i/Math.sqrt(s*s+i*i),o=3.9/(r*n);this.d=2*r*o,this.k=o*o}class Bi extends ee{constructor(t=500,e=0){super(),this.duration(t).overshoot(e)}step(t,e,s,i){if(typeof t=="string")return t;if(i.done=s===1/0,s===1/0)return e;if(s===0)return t;s>100&&(s=16),s/=1e3;const r=i.velocity||0,o=-this.d*r-this.k*(t-e),a=t+r*s+o*s*s/2;return i.velocity=r+o*s,i.done=Math.abs(e-a)+Math.abs(r)<.002,i.done?e:a}}x(Bi,{duration:St("_duration",un),overshoot:St("_overshoot",un)});class $i extends ee{constructor(t=.1,e=.01,s=0,i=1e3){super(),this.p(t).i(e).d(s).windup(i)}step(t,e,s,i){if(typeof t=="string")return t;if(i.done=s===1/0,s===1/0)return e;if(s===0)return t;const r=e-t;let o=(i.integral||0)+r*s;const a=(r-(i.error||0))/s,l=this._windup;return l!==!1&&(o=Math.max(-l,Math.min(o,l))),i.error=r,i.integral=o,i.done=Math.abs(r)<.001,i.done?e:t+(this.P*r+this.I*o+this.D*a)}}x($i,{windup:St("_windup"),p:St("P"),i:St("I"),d:St("D")});const ji={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0},Ee={M:function(n,t,e){return t.x=e.x=n[0],t.y=e.y=n[1],["M",t.x,t.y]},L:function(n,t){return t.x=n[0],t.y=n[1],["L",n[0],n[1]]},H:function(n,t){return t.x=n[0],["H",n[0]]},V:function(n,t){return t.y=n[0],["V",n[0]]},C:function(n,t){return t.x=n[4],t.y=n[5],["C",n[0],n[1],n[2],n[3],n[4],n[5]]},S:function(n,t){return t.x=n[2],t.y=n[3],["S",n[0],n[1],n[2],n[3]]},Q:function(n,t){return t.x=n[2],t.y=n[3],["Q",n[0],n[1],n[2],n[3]]},T:function(n,t){return t.x=n[0],t.y=n[1],["T",n[0],n[1]]},Z:function(n,t,e){return t.x=e.x,t.y=e.y,["Z"]},A:function(n,t){return t.x=n[5],t.y=n[6],["A",n[0],n[1],n[2],n[3],n[4],n[5],n[6]]}},ge="mlhvqtcsaz".split("");for(let n=0,t=ge.length;n<t;++n)Ee[ge[n]]=function(e){return function(s,i,r){if(e==="H")s[0]=s[0]+i.x;else if(e==="V")s[0]=s[0]+i.y;else if(e==="A")s[5]=s[5]+i.x,s[6]=s[6]+i.y;else for(let o=0,a=s.length;o<a;++o)s[o]=s[o]+(o%2?i.y:i.x);return Ee[e](s,i,r)}}(ge[n].toUpperCase());function Wi(n){const t=n.segment[0];return Ee[t](n.segment.slice(1),n.p,n.p0)}function Te(n){return n.segment.length&&n.segment.length-1===ji[n.segment[0].toUpperCase()]}function Yi(n,t){n.inNumber&&pt(n,!1);const e=Be.test(t);if(e)n.segment=[t];else{const s=n.lastCommand,i=s.toLowerCase(),r=s===i;n.segment=[i==="m"?r?"l":"L":s]}return n.inSegment=!0,n.lastCommand=n.segment[0],e}function pt(n,t){if(!n.inNumber)throw new Error("Parser Error");n.number&&n.segment.push(parseFloat(n.number)),n.inNumber=t,n.number="",n.pointSeen=!1,n.hasExponent=!1,Te(n)&&Se(n)}function Se(n){n.inSegment=!1,n.absolute&&(n.segment=Wi(n)),n.segments.push(n.segment)}function qi(n){if(!n.segment.length)return!1;const t=n.segment[0].toUpperCase()==="A",e=n.segment.length;return t&&(e===4||e===5)}function Ui(n){return n.lastToken.toUpperCase()==="E"}const Xi=new Set([" ",",","	",`
`,"\r","\f"]);function Gi(n,t=!0){let e=0,s="";const i={segment:[],inNumber:!1,number:"",lastToken:"",inSegment:!1,segments:[],pointSeen:!1,hasExponent:!1,absolute:t,p0:new N,p:new N};for(;i.lastToken=s,s=n.charAt(e++);)if(!(!i.inSegment&&Yi(i,s))){if(s==="."){if(i.pointSeen||i.hasExponent){pt(i,!1),--e;continue}i.inNumber=!0,i.pointSeen=!0,i.number+=s;continue}if(!isNaN(parseInt(s))){if(i.number==="0"||qi(i)){i.inNumber=!0,i.number=s,pt(i,!0);continue}i.inNumber=!0,i.number+=s;continue}if(Xi.has(s)){i.inNumber&&pt(i,!1);continue}if(s==="-"||s==="+"){if(i.inNumber&&!Ui(i)){pt(i,!1),--e;continue}i.number+=s,i.inNumber=!0;continue}if(s.toUpperCase()==="E"){i.number+=s,i.hasExponent=!0;continue}if(Be.test(s)){if(i.inNumber)pt(i,!1);else if(Te(i))Se(i);else throw new Error("parser Error");--e}}return i.inNumber&&pt(i,!1),i.inSegment&&Te(i)&&Se(i),i.segments}function Ki(n){let t="";for(let e=0,s=n.length;e<s;e++)t+=n[e][0],n[e][1]!=null&&(t+=n[e][1],n[e][2]!=null&&(t+=" ",t+=n[e][2],n[e][3]!=null&&(t+=" ",t+=n[e][3],t+=" ",t+=n[e][4],n[e][5]!=null&&(t+=" ",t+=n[e][5],t+=" ",t+=n[e][6],n[e][7]!=null&&(t+=" ",t+=n[e][7])))));return t+" "}class _t extends At{bbox(){return ht().path.setAttribute("d",this.toString()),new H(ht.nodes.path.getBBox())}move(t,e){const s=this.bbox();if(t-=s.x,e-=s.y,!isNaN(t)&&!isNaN(e))for(let i,r=this.length-1;r>=0;r--)i=this[r][0],i==="M"||i==="L"||i==="T"?(this[r][1]+=t,this[r][2]+=e):i==="H"?this[r][1]+=t:i==="V"?this[r][1]+=e:i==="C"||i==="S"||i==="Q"?(this[r][1]+=t,this[r][2]+=e,this[r][3]+=t,this[r][4]+=e,i==="C"&&(this[r][5]+=t,this[r][6]+=e)):i==="A"&&(this[r][6]+=t,this[r][7]+=e);return this}parse(t="M0 0"){return Array.isArray(t)&&(t=Array.prototype.concat.apply([],t).toString()),Gi(t)}size(t,e){const s=this.bbox();let i,r;for(s.width=s.width===0?1:s.width,s.height=s.height===0?1:s.height,i=this.length-1;i>=0;i--)r=this[i][0],r==="M"||r==="L"||r==="T"?(this[i][1]=(this[i][1]-s.x)*t/s.width+s.x,this[i][2]=(this[i][2]-s.y)*e/s.height+s.y):r==="H"?this[i][1]=(this[i][1]-s.x)*t/s.width+s.x:r==="V"?this[i][1]=(this[i][1]-s.y)*e/s.height+s.y:r==="C"||r==="S"||r==="Q"?(this[i][1]=(this[i][1]-s.x)*t/s.width+s.x,this[i][2]=(this[i][2]-s.y)*e/s.height+s.y,this[i][3]=(this[i][3]-s.x)*t/s.width+s.x,this[i][4]=(this[i][4]-s.y)*e/s.height+s.y,r==="C"&&(this[i][5]=(this[i][5]-s.x)*t/s.width+s.x,this[i][6]=(this[i][6]-s.y)*e/s.height+s.y)):r==="A"&&(this[i][1]=this[i][1]*t/s.width,this[i][2]=this[i][2]*e/s.height,this[i][6]=(this[i][6]-s.x)*t/s.width+s.x,this[i][7]=(this[i][7]-s.y)*e/s.height+s.y);return this}toString(){return Ki(this)}}const Bn=n=>{const t=typeof n;return t==="number"?_:t==="string"?k.isColor(n)?k:at.test(n)?Be.test(n)?_t:At:An.test(n)?_:Ae:Xe.indexOf(n.constructor)>-1?n.constructor:Array.isArray(n)?At:t==="object"?Bt:Ae};class mt{constructor(t){this._stepper=t||new ve("-"),this._from=null,this._to=null,this._type=null,this._context=null,this._morphObj=null}at(t){return this._morphObj.morph(this._from,this._to,t,this._stepper,this._context)}done(){return this._context.map(this._stepper.done).reduce(function(e,s){return e&&s},!0)}from(t){return t==null?this._from:(this._from=this._set(t),this)}stepper(t){return t==null?this._stepper:(this._stepper=t,this)}to(t){return t==null?this._to:(this._to=this._set(t),this)}type(t){return t==null?this._type:(this._type=t,this)}_set(t){this._type||this.type(Bn(t));let e=new this._type(t);return this._type===k&&(e=this._to?e[this._to[4]]():this._from?e[this._from[4]]():e),this._type===Bt&&(e=this._to?e.align(this._to):this._from?e.align(this._from):e),e=e.toConsumable(),this._morphObj=this._morphObj||new this._type,this._context=this._context||Array.apply(null,Array(e.length)).map(Object).map(function(s){return s.done=!0,s}),e}}class Ae{constructor(...t){this.init(...t)}init(t){return t=Array.isArray(t)?t[0]:t,this.value=t,this}toArray(){return[this.value]}valueOf(){return this.value}}class Gt{constructor(...t){this.init(...t)}init(t){return Array.isArray(t)&&(t={scaleX:t[0],scaleY:t[1],shear:t[2],rotate:t[3],translateX:t[4],translateY:t[5],originX:t[6],originY:t[7]}),Object.assign(this,Gt.defaults,t),this}toArray(){const t=this;return[t.scaleX,t.scaleY,t.shear,t.rotate,t.translateX,t.translateY,t.originX,t.originY]}}Gt.defaults={scaleX:1,scaleY:1,shear:0,rotate:0,translateX:0,translateY:0,originX:0,originY:0};const Ji=(n,t)=>n[0]<t[0]?-1:n[0]>t[0]?1:0;class Bt{constructor(...t){this.init(...t)}align(t){const e=this.values;for(let s=0,i=e.length;s<i;++s){if(e[s+1]===t[s+1]){if(e[s+1]===k&&t[s+7]!==e[s+7]){const a=t[s+7],l=new k(this.values.splice(s+3,5))[a]().toArray();this.values.splice(s+3,0,...l)}s+=e[s+2]+2;continue}if(!t[s+1])return this;const r=new t[s+1]().toArray(),o=e[s+2]+3;e.splice(s,o,t[s],t[s+1],t[s+2],...r),s+=e[s+2]+2}return this}init(t){if(this.values=[],Array.isArray(t)){this.values=t.slice();return}t=t||{};const e=[];for(const s in t){const i=Bn(t[s]),r=new i(t[s]).toArray();e.push([s,i,r.length,...r])}return e.sort(Ji),this.values=e.reduce((s,i)=>s.concat(i),[]),this}toArray(){return this.values}valueOf(){const t={},e=this.values;for(;e.length;){const s=e.shift(),i=e.shift(),r=e.shift(),o=e.splice(0,r);t[s]=new i(o)}return t}}const Xe=[Ae,Gt,Bt];function Qi(n=[]){Xe.push(...[].concat(n))}function Zi(){x(Xe,{to(n){return new mt().type(this.constructor).from(this.toArray()).to(n)},fromArray(n){return this.init(n),this},toConsumable(){return this.toArray()},morph(n,t,e,s,i){const r=function(o,a){return s.step(o,t[a],e,i[a],i)};return this.fromArray(n.map(r))}})}class kt extends Q{constructor(t,e=t){super(R("path",t),e)}array(){return this._array||(this._array=new _t(this.attr("d")))}clear(){return delete this._array,this}height(t){return t==null?this.bbox().height:this.size(this.bbox().width,t)}move(t,e){return this.attr("d",this.array().move(t,e))}plot(t){return t==null?this.array():this.clear().attr("d",typeof t=="string"?t:this._array=new _t(t))}size(t,e){const s=Dt(this,t,e);return this.attr("d",this.array().size(s.width,s.height))}width(t){return t==null?this.bbox().width:this.size(t,this.bbox().height)}x(t){return t==null?this.bbox().x:this.move(t,this.bbox().y)}y(t){return t==null?this.bbox().y:this.move(this.bbox().x,t)}}kt.prototype.MorphArray=_t;v({Container:{path:F(function(n){return this.put(new kt).plot(n||new _t)})}});S(kt,"Path");function tr(){return this._array||(this._array=new dt(this.attr("points")))}function er(){return delete this._array,this}function nr(n,t){return this.attr("points",this.array().move(n,t))}function sr(n){return n==null?this.array():this.clear().attr("points",typeof n=="string"?n:this._array=new dt(n))}function ir(n,t){const e=Dt(this,n,t);return this.attr("points",this.array().size(e.width,e.height))}const $n=Object.freeze(Object.defineProperty({__proto__:null,array:tr,clear:er,move:nr,plot:sr,size:ir},Symbol.toStringTag,{value:"Module"}));class xt extends Q{constructor(t,e=t){super(R("polygon",t),e)}}v({Container:{polygon:F(function(n){return this.put(new xt).plot(n||new dt)})}});x(xt,qe);x(xt,$n);S(xt,"Polygon");class vt extends Q{constructor(t,e=t){super(R("polyline",t),e)}}v({Container:{polyline:F(function(n){return this.put(new vt).plot(n||new dt)})}});x(vt,qe);x(vt,$n);S(vt,"Polyline");class ue extends Q{constructor(t,e=t){super(R("rect",t),e)}}x(ue,{rx:We,ry:Ye});v({Container:{rect:F(function(n,t){return this.put(new ue).size(n,t)})}});S(ue,"Rect");class ye{constructor(){this._first=null,this._last=null}first(){return this._first&&this._first.value}last(){return this._last&&this._last.value}push(t){const e=typeof t.next<"u"?t:{value:t,next:null,prev:null};return this._last?(e.prev=this._last,this._last.next=e,this._last=e):(this._last=e,this._first=e),e}remove(t){t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t===this._last&&(this._last=t.prev),t===this._first&&(this._first=t.next),t.prev=null,t.next=null}shift(){const t=this._first;return t?(this._first=t.next,this._first&&(this._first.prev=null),this._last=this._first?this._last:null,t.value):null}}const D={nextDraw:null,frames:new ye,timeouts:new ye,immediates:new ye,timer:()=>T.window.performance||T.window.Date,transforms:[],frame(n){const t=D.frames.push({run:n});return D.nextDraw===null&&(D.nextDraw=T.window.requestAnimationFrame(D._draw)),t},timeout(n,t){t=t||0;const e=D.timer().now()+t,s=D.timeouts.push({run:n,time:e});return D.nextDraw===null&&(D.nextDraw=T.window.requestAnimationFrame(D._draw)),s},immediate(n){const t=D.immediates.push(n);return D.nextDraw===null&&(D.nextDraw=T.window.requestAnimationFrame(D._draw)),t},cancelFrame(n){n!=null&&D.frames.remove(n)},clearTimeout(n){n!=null&&D.timeouts.remove(n)},cancelImmediate(n){n!=null&&D.immediates.remove(n)},_draw(n){let t=null;const e=D.timeouts.last();for(;(t=D.timeouts.shift())&&(n>=t.time?t.run():D.timeouts.push(t),t!==e););let s=null;const i=D.frames.last();for(;s!==i&&(s=D.frames.shift());)s.run(n);let r=null;for(;r=D.immediates.shift();)r();D.nextDraw=D.timeouts.first()||D.frames.first()?T.window.requestAnimationFrame(D._draw):null}},rr=function(n){const t=n.start,e=n.runner.duration(),s=t+e;return{start:t,duration:e,end:s,runner:n.runner}},or=function(){const n=T.window;return(n.performance||n.Date).now()};class jn extends Ut{constructor(t=or){super(),this._timeSource=t,this.terminate()}active(){return!!this._nextFrame}finish(){return this.time(this.getEndTimeOfTimeline()+1),this.pause()}getEndTime(){const t=this.getLastRunnerInfo(),e=t?t.runner.duration():0;return(t?t.start:this._time)+e}getEndTimeOfTimeline(){const t=this._runners.map(e=>e.start+e.runner.duration());return Math.max(0,...t)}getLastRunnerInfo(){return this.getRunnerInfoById(this._lastRunnerId)}getRunnerInfoById(t){return this._runners[this._runnerIds.indexOf(t)]||null}pause(){return this._paused=!0,this._continue()}persist(t){return t==null?this._persist:(this._persist=t,this)}play(){return this._paused=!1,this.updateTime()._continue()}reverse(t){const e=this.speed();if(t==null)return this.speed(-e);const s=Math.abs(e);return this.speed(t?-s:s)}schedule(t,e,s){if(t==null)return this._runners.map(rr);let i=0;const r=this.getEndTime();if(e=e||0,s==null||s==="last"||s==="after")i=r;else if(s==="absolute"||s==="start")i=e,e=0;else if(s==="now")i=this._time;else if(s==="relative"){const l=this.getRunnerInfoById(t.id);l&&(i=l.start+e,e=0)}else if(s==="with-last"){const l=this.getLastRunnerInfo();i=l?l.start:this._time}else throw new Error('Invalid value for the "when" parameter');t.unschedule(),t.timeline(this);const o=t.persist(),a={persist:o===null?this._persist:o,start:i+e,runner:t};return this._lastRunnerId=t.id,this._runners.push(a),this._runners.sort((l,u)=>l.start-u.start),this._runnerIds=this._runners.map(l=>l.runner.id),this.updateTime()._continue(),this}seek(t){return this.time(this._time+t)}source(t){return t==null?this._timeSource:(this._timeSource=t,this)}speed(t){return t==null?this._speed:(this._speed=t,this)}stop(){return this.time(0),this.pause()}time(t){return t==null?this._time:(this._time=t,this._continue(!0))}unschedule(t){const e=this._runnerIds.indexOf(t.id);return e<0?this:(this._runners.splice(e,1),this._runnerIds.splice(e,1),t.timeline(null),this)}updateTime(){return this.active()||(this._lastSourceTime=this._timeSource()),this}_continue(t=!1){return D.cancelFrame(this._nextFrame),this._nextFrame=null,t?this._stepImmediate():this._paused?this:(this._nextFrame=D.frame(this._step),this)}_stepFn(t=!1){const e=this._timeSource();let s=e-this._lastSourceTime;t&&(s=0);const i=this._speed*s+(this._time-this._lastStepTime);this._lastSourceTime=e,t||(this._time+=i,this._time=this._time<0?0:this._time),this._lastStepTime=this._time,this.fire("time",this._time);for(let o=this._runners.length;o--;){const a=this._runners[o],l=a.runner;this._time-a.start<=0&&l.reset()}let r=!1;for(let o=0,a=this._runners.length;o<a;o++){const l=this._runners[o],u=l.runner;let h=i;const c=this._time-l.start;if(c<=0){r=!0;continue}else c<h&&(h=c);if(!u.active())continue;u.step(h).done?l.persist!==!0&&u.duration()-u.time()+this._time+l.persist<this._time&&(u.unschedule(),--o,--a):r=!0}return r&&!(this._speed<0&&this._time===0)||this._runnerIds.length&&this._speed<0&&this._time>0?this._continue():(this.pause(),this.fire("finished")),this}terminate(){this._startTime=0,this._speed=1,this._persist=0,this._nextFrame=null,this._paused=!0,this._runners=[],this._runnerIds=[],this._lastRunnerId=-1,this._time=0,this._lastSourceTime=0,this._lastStepTime=0,this._step=this._stepFn.bind(this,!1),this._stepImmediate=this._stepFn.bind(this,!0)}}v({Element:{timeline:function(n){return n==null?(this._timeline=this._timeline||new jn,this._timeline):(this._timeline=n,this)}}});class J extends Ut{constructor(t){super(),this.id=J.id++,t=t??Rt.duration,t=typeof t=="function"?new ee(t):t,this._element=null,this._timeline=null,this.done=!1,this._queue=[],this._duration=typeof t=="number"&&t,this._isDeclarative=t instanceof ee,this._stepper=this._isDeclarative?t:new ve,this._history={},this.enabled=!0,this._time=0,this._lastTime=0,this._reseted=!0,this.transforms=new b,this.transformId=1,this._haveReversed=!1,this._reverse=!1,this._loopsDone=0,this._swing=!1,this._wait=0,this._times=1,this._frameId=null,this._persist=this._isDeclarative?!0:null}static sanitise(t,e,s){let i=1,r=!1,o=0;return t=t??Rt.duration,e=e??Rt.delay,s=s||"last",typeof t=="object"&&!(t instanceof Ue)&&(e=t.delay??e,s=t.when??s,r=t.swing||r,i=t.times??i,o=t.wait??o,t=t.duration??Rt.duration),{duration:t,delay:e,swing:r,times:i,wait:o,when:s}}active(t){return t==null?this.enabled:(this.enabled=t,this)}addTransform(t){return this.transforms.lmultiplyO(t),this}after(t){return this.on("finished",t)}animate(t,e,s){const i=J.sanitise(t,e,s),r=new J(i.duration);return this._timeline&&r.timeline(this._timeline),this._element&&r.element(this._element),r.loop(i).schedule(i.delay,i.when)}clearTransform(){return this.transforms=new b,this}clearTransformsFromQueue(){(!this.done||!this._timeline||!this._timeline._runnerIds.includes(this.id))&&(this._queue=this._queue.filter(t=>!t.isTransform))}delay(t){return this.animate(0,t)}duration(){return this._times*(this._wait+this._duration)-this._wait}during(t){return this.queue(null,t)}ease(t){return this._stepper=new ve(t),this}element(t){return t==null?this._element:(this._element=t,t._prepareRunner(),this)}finish(){return this.step(1/0)}loop(t,e,s){return typeof t=="object"&&(e=t.swing,s=t.wait,t=t.times),this._times=t||1/0,this._swing=e||!1,this._wait=s||0,this._times===!0&&(this._times=1/0),this}loops(t){const e=this._duration+this._wait;if(t==null){const o=Math.floor(this._time/e),l=(this._time-o*e)/this._duration;return Math.min(o+l,this._times)}const s=Math.floor(t),i=t%1,r=e*s+this._duration*i;return this.time(r)}persist(t){return t==null?this._persist:(this._persist=t,this)}position(t){const e=this._time,s=this._duration,i=this._wait,r=this._times,o=this._swing,a=this._reverse;let l;if(t==null){const f=function(g){const p=o*Math.floor(g%(2*(i+s))/(i+s)),w=p&&!a||!p&&a,A=Math.pow(-1,w)*(g%(i+s))/s+w;return Math.max(Math.min(A,1),0)},d=r*(i+s)-i;return l=e<=0?Math.round(f(1e-5)):e<d?f(e):Math.round(f(d-1e-5)),l}const u=Math.floor(this.loops()),h=o&&u%2===0;return l=u+(h&&!a||a&&h?t:1-t),this.loops(l)}progress(t){return t==null?Math.min(1,this._time/this.duration()):this.time(t*this.duration())}queue(t,e,s,i){return this._queue.push({initialiser:t||ln,runner:e||ln,retarget:s,isTransform:i,initialised:!1,finished:!1}),this.timeline()&&this.timeline()._continue(),this}reset(){return this._reseted?this:(this.time(0),this._reseted=!0,this)}reverse(t){return this._reverse=t??!this._reverse,this}schedule(t,e,s){if(t instanceof jn||(s=e,e=t,t=this.timeline()),!t)throw Error("Runner cannot be scheduled without timeline");return t.schedule(this,e,s),this}step(t){if(!this.enabled)return this;t=t??16,this._time+=t;const e=this.position(),s=this._lastPosition!==e&&this._time>=0;this._lastPosition=e;const i=this.duration(),r=this._lastTime<=0&&this._time>0,o=this._lastTime<i&&this._time>=i;this._lastTime=this._time,r&&this.fire("start",this);const a=this._isDeclarative;this.done=!a&&!o&&this._time>=i,this._reseted=!1;let l=!1;return(s||a)&&(this._initialise(s),this.transforms=new b,l=this._run(a?t:e),this.fire("step",this)),this.done=this.done||l&&a,o&&this.fire("finished",this),this}time(t){if(t==null)return this._time;const e=t-this._time;return this.step(e),this}timeline(t){return typeof t>"u"?this._timeline:(this._timeline=t,this)}unschedule(){const t=this.timeline();return t&&t.unschedule(this),this}_initialise(t){if(!(!t&&!this._isDeclarative))for(let e=0,s=this._queue.length;e<s;++e){const i=this._queue[e],r=this._isDeclarative||!i.initialised&&t;t=!i.finished,r&&t&&(i.initialiser.call(this),i.initialised=!0)}}_rememberMorpher(t,e){if(this._history[t]={morpher:e,caller:this._queue[this._queue.length-1]},this._isDeclarative){const s=this.timeline();s&&s.play()}}_run(t){let e=!0;for(let s=0,i=this._queue.length;s<i;++s){const r=this._queue[s],o=r.runner.call(this,t);r.finished=r.finished||o===!0,e=e&&r.finished}return e}_tryRetarget(t,e,s){if(this._history[t]){if(!this._history[t].caller.initialised){const r=this._queue.indexOf(this._history[t].caller);return this._queue.splice(r,1),!1}this._history[t].caller.retarget?this._history[t].caller.retarget.call(this,e,s):this._history[t].morpher.to(e),this._history[t].caller.finished=!1;const i=this.timeline();return i&&i.play(),!0}return!1}}J.id=0;class ne{constructor(t=new b,e=-1,s=!0){this.transforms=t,this.id=e,this.done=s}clearTransformsFromQueue(){}}x([J,ne],{mergeWith(n){return new ne(n.transforms.lmultiply(this.transforms),n.id)}});const Wn=(n,t)=>n.lmultiplyO(t),Yn=n=>n.transforms;function ar(){const t=this._transformationRunners.runners.map(Yn).reduce(Wn,new b);this.transform(t),this._transformationRunners.merge(),this._transformationRunners.length()===1&&(this._frameId=null)}class lr{constructor(){this.runners=[],this.ids=[]}add(t){if(this.runners.includes(t))return;const e=t.id+1;return this.runners.push(t),this.ids.push(e),this}clearBefore(t){const e=this.ids.indexOf(t+1)||1;return this.ids.splice(0,e,0),this.runners.splice(0,e,new ne).forEach(s=>s.clearTransformsFromQueue()),this}edit(t,e){const s=this.ids.indexOf(t+1);return this.ids.splice(s,1,t+1),this.runners.splice(s,1,e),this}getByID(t){return this.runners[this.ids.indexOf(t+1)]}length(){return this.ids.length}merge(){let t=null;for(let e=0;e<this.runners.length;++e){const s=this.runners[e];if(t&&s.done&&t.done&&(!s._timeline||!s._timeline._runnerIds.includes(s.id))&&(!t._timeline||!t._timeline._runnerIds.includes(t.id))){this.remove(s.id);const r=s.mergeWith(t);this.edit(t.id,r),t=r,--e}else t=s}return this}remove(t){const e=this.ids.indexOf(t+1);return this.ids.splice(e,1),this.runners.splice(e,1),this}}v({Element:{animate(n,t,e){const s=J.sanitise(n,t,e),i=this.timeline();return new J(s.duration).loop(s).element(this).timeline(i.play()).schedule(s.delay,s.when)},delay(n,t){return this.animate(0,n,t)},_clearTransformRunnersBefore(n){this._transformationRunners.clearBefore(n.id)},_currentTransform(n){return this._transformationRunners.runners.filter(t=>t.id<=n.id).map(Yn).reduce(Wn,new b)},_addRunner(n){this._transformationRunners.add(n),D.cancelImmediate(this._frameId),this._frameId=D.immediate(ar.bind(this))},_prepareRunner(){this._frameId==null&&(this._transformationRunners=new lr().add(new ne(new b(this))))}}});const ur=(n,t)=>n.filter(e=>!t.includes(e));x(J,{attr(n,t){return this.styleAttr("attr",n,t)},css(n,t){return this.styleAttr("css",n,t)},styleAttr(n,t,e){if(typeof t=="string")return this.styleAttr(n,{[t]:e});let s=t;if(this._tryRetarget(n,s))return this;let i=new mt(this._stepper).to(s),r=Object.keys(s);return this.queue(function(){i=i.from(this.element()[n](r))},function(o){return this.element()[n](i.at(o).valueOf()),i.done()},function(o){const a=Object.keys(o),l=ur(a,r);if(l.length){const h=this.element()[n](l),c=new Bt(i.from()).valueOf();Object.assign(c,h),i.from(c)}const u=new Bt(i.to()).valueOf();Object.assign(u,o),i.to(u),r=a,s=o}),this._rememberMorpher(n,i),this},zoom(n,t){if(this._tryRetarget("zoom",n,t))return this;let e=new mt(this._stepper).to(new _(n));return this.queue(function(){e=e.from(this.element().zoom())},function(s){return this.element().zoom(e.at(s),t),e.done()},function(s,i){t=i,e.to(s)}),this._rememberMorpher("zoom",e),this},transform(n,t,e){if(t=n.relative||t,this._isDeclarative&&!t&&this._tryRetarget("transform",n))return this;const s=b.isMatrixLike(n);e=n.affine!=null?n.affine:e??!s;const i=new mt(this._stepper).type(e?Gt:b);let r,o,a,l,u;function h(){o=o||this.element(),r=r||_e(n,o),u=new b(t?void 0:o),o._addRunner(this),t||o._clearTransformRunnersBefore(this)}function c(d){t||this.clearTransform();const{x:g,y:p}=new N(r).transform(o._currentTransform(this));let w=new b({...n,origin:[g,p]}),A=this._isDeclarative&&a?a:u;if(e){w=w.decompose(g,p),A=A.decompose(g,p);const O=w.rotate,Y=A.rotate,P=[O-360,O,O+360],G=P.map(Mt=>Math.abs(Mt-Y)),st=Math.min(...G),lt=G.indexOf(st);w.rotate=P[lt]}t&&(s||(w.rotate=n.rotate||0),this._isDeclarative&&l&&(A.rotate=l)),i.from(A),i.to(w);const z=i.at(d);return l=z.rotate,a=new b(z),this.addTransform(a),o._addRunner(this),i.done()}function f(d){(d.origin||"center").toString()!==(n.origin||"center").toString()&&(r=_e(d,o)),n={...d,origin:r}}return this.queue(h,c,f,!0),this._isDeclarative&&this._rememberMorpher("transform",i),this},x(n){return this._queueNumber("x",n)},y(n){return this._queueNumber("y",n)},ax(n){return this._queueNumber("ax",n)},ay(n){return this._queueNumber("ay",n)},dx(n=0){return this._queueNumberDelta("x",n)},dy(n=0){return this._queueNumberDelta("y",n)},dmove(n,t){return this.dx(n).dy(t)},_queueNumberDelta(n,t){if(t=new _(t),this._tryRetarget(n,t))return this;const e=new mt(this._stepper).to(t);let s=null;return this.queue(function(){s=this.element()[n](),e.from(s),e.to(s+t)},function(i){return this.element()[n](e.at(i)),e.done()},function(i){e.to(s+new _(i))}),this._rememberMorpher(n,e),this},_queueObject(n,t){if(this._tryRetarget(n,t))return this;const e=new mt(this._stepper).to(t);return this.queue(function(){e.from(this.element()[n]())},function(s){return this.element()[n](e.at(s)),e.done()}),this._rememberMorpher(n,e),this},_queueNumber(n,t){return this._queueObject(n,new _(t))},cx(n){return this._queueNumber("cx",n)},cy(n){return this._queueNumber("cy",n)},move(n,t){return this.x(n).y(t)},amove(n,t){return this.ax(n).ay(t)},center(n,t){return this.cx(n).cy(t)},size(n,t){let e;return(!n||!t)&&(e=this._element.bbox()),n||(n=e.width/e.height*t),t||(t=e.height/e.width*n),this.width(n).height(t)},width(n){return this._queueNumber("width",n)},height(n){return this._queueNumber("height",n)},plot(n,t,e,s){if(arguments.length===4)return this.plot([n,t,e,s]);if(this._tryRetarget("plot",n))return this;const i=new mt(this._stepper).type(this._element.MorphArray).to(n);return this.queue(function(){i.from(this._element.array())},function(r){return this._element.plot(i.at(r)),i.done()}),this._rememberMorpher("plot",i),this},leading(n){return this._queueNumber("leading",n)},viewbox(n,t,e,s){return this._queueObject("viewbox",new H(n,t,e,s))},update(n){return typeof n!="object"?this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]}):(n.opacity!=null&&this.attr("stop-opacity",n.opacity),n.color!=null&&this.attr("stop-color",n.color),n.offset!=null&&this.attr("offset",n.offset),this)}});x(J,{rx:We,ry:Ye,from:In,to:Vn});S(J,"Runner");class Ge extends X{constructor(t,e=t){super(R("svg",t),e),this.namespace()}defs(){return this.isRoot()?Z(this.node.querySelector("defs"))||this.put(new je):this.root().defs()}isRoot(){return!this.node.parentNode||!(this.node.parentNode instanceof T.window.SVGElement)&&this.node.parentNode.nodeName!=="#document-fragment"}namespace(){return this.isRoot()?this.attr({xmlns:Le,version:"1.1"}).attr("xmlns:xlink",Yt,fe):this.root().namespace()}removeNamespace(){return this.attr({xmlns:null,version:null}).attr("xmlns:xlink",null,fe).attr("xmlns:svgjs",null,fe)}root(){return this.isRoot()?this:super.root()}}v({Container:{nested:F(function(){return this.put(new Ge)})}});S(Ge,"Svg",!0);let Ke=class extends X{constructor(t,e=t){super(R("symbol",t),e)}};v({Container:{symbol:F(function(){return this.put(new Ke)})}});S(Ke,"Symbol");function hr(n){return this._build===!1&&this.clear(),this.node.appendChild(T.document.createTextNode(n)),this}function cr(){return this.node.getComputedTextLength()}function dr(n,t=this.bbox()){return n==null?t.x:this.attr("x",this.attr("x")+n-t.x)}function fr(n,t=this.bbox()){return n==null?t.y:this.attr("y",this.attr("y")+n-t.y)}function pr(n,t,e=this.bbox()){return this.x(n,e).y(t,e)}function mr(n,t=this.bbox()){return n==null?t.cx:this.attr("x",this.attr("x")+n-t.cx)}function gr(n,t=this.bbox()){return n==null?t.cy:this.attr("y",this.attr("y")+n-t.cy)}function yr(n,t,e=this.bbox()){return this.cx(n,e).cy(t,e)}function br(n){return this.attr("x",n)}function wr(n){return this.attr("y",n)}function _r(n,t){return this.ax(n).ay(t)}function xr(n){return this._build=!!n,this}const qn=Object.freeze(Object.defineProperty({__proto__:null,amove:_r,ax:br,ay:wr,build:xr,center:yr,cx:mr,cy:gr,length:cr,move:pr,plain:hr,x:dr,y:fr},Symbol.toStringTag,{value:"Module"}));class et extends Q{constructor(t,e=t){super(R("text",t),e),this.dom.leading=this.dom.leading??new _(1.3),this._rebuild=!0,this._build=!1}leading(t){return t==null?this.dom.leading:(this.dom.leading=new _(t),this.rebuild())}rebuild(t){if(typeof t=="boolean"&&(this._rebuild=t),this._rebuild){const e=this;let s=0;const i=this.dom.leading;this.each(function(r){if(xe(this.node))return;const o=T.window.getComputedStyle(this.node).getPropertyValue("font-size"),a=i*new _(o);this.dom.newLined&&(this.attr("x",e.attr("x")),this.text()===`
`?s+=a:(this.attr("dy",r?a+s:0),s=0))}),this.fire("rebuild")}return this}setData(t){return this.dom=t,this.dom.leading=new _(t.leading||1.3),this}writeDataToDom(){return En(this,this.dom,{leading:1.3}),this}text(t){if(t===void 0){const e=this.node.childNodes;let s=0;t="";for(let i=0,r=e.length;i<r;++i){if(e[i].nodeName==="textPath"||xe(e[i])){i===0&&(s=i+1);continue}i!==s&&e[i].nodeType!==3&&Z(e[i]).dom.newLined===!0&&(t+=`
`),t+=e[i].textContent}return t}if(this.clear().build(!0),typeof t=="function")t.call(this,this);else{t=(t+"").split(`
`);for(let e=0,s=t.length;e<s;e++)this.newLine(t[e])}return this.build(!1).rebuild()}}x(et,qn);v({Container:{text:F(function(n=""){return this.put(new et).text(n)}),plain:F(function(n=""){return this.put(new et).plain(n)})}});S(et,"Text");class he extends Q{constructor(t,e=t){super(R("tspan",t),e),this._build=!1}dx(t){return this.attr("dx",t)}dy(t){return this.attr("dy",t)}newLine(){this.dom.newLined=!0;const t=this.parent();if(!(t instanceof et))return this;const e=t.index(this),s=T.window.getComputedStyle(this.node).getPropertyValue("font-size"),i=t.dom.leading*new _(s);return this.dy(e?i:0).attr("x",t.x())}text(t){return t==null?this.node.textContent+(this.dom.newLined?`
`:""):(typeof t=="function"?(this.clear().build(!0),t.call(this,this),this.build(!1)):this.plain(t),this)}}x(he,qn);v({Tspan:{tspan:F(function(n=""){const t=new he;return this._build||this.clear(),this.put(t).text(n)})},Text:{newLine:function(n=""){return this.tspan(n).newLine()}}});S(he,"Tspan");class Je extends Q{constructor(t,e=t){super(R("circle",t),e)}radius(t){return this.attr("r",t)}rx(t){return this.attr("r",t)}ry(t){return this.rx(t)}size(t){return this.radius(new _(t).divide(2))}}x(Je,{x:Fn,y:Rn,cx:Nn,cy:zn,width:On,height:Hn});v({Container:{circle:F(function(n=0){return this.put(new Je).size(n).move(0,0)})}});S(Je,"Circle");class De extends X{constructor(t,e=t){super(R("clipPath",t),e)}remove(){return this.targets().forEach(function(t){t.unclip()}),super.remove()}targets(){return Ct("svg [clip-path*="+this.id()+"]")}}v({Container:{clip:F(function(){return this.defs().put(new De)})},Element:{clipper(){return this.reference("clip-path")},clipWith(n){const t=n instanceof De?n:this.parent().clip().add(n);return this.attr("clip-path","url(#"+t.id()+")")},unclip(){return this.attr("clip-path",null)}}});S(De,"ClipPath");class Un extends U{constructor(t,e=t){super(R("foreignObject",t),e)}}v({Container:{foreignObject:F(function(n,t){return this.put(new Un).size(n,t)})}});S(Un,"ForeignObject");function vr(n,t){return this.children().forEach(e=>{let s;try{s=e.node instanceof qt().SVGSVGElement?new H(e.attr(["x","y","width","height"])):e.bbox()}catch{return}const i=new b(e),r=i.translate(n,t).transform(i.inverse()),o=new N(s.x,s.y).transform(r);e.move(o.x,o.y)}),this}function Er(n){return this.dmove(n,0)}function Tr(n){return this.dmove(0,n)}function Sr(n,t=this.bbox()){return n==null?t.height:this.size(t.width,n,t)}function Ar(n=0,t=0,e=this.bbox()){const s=n-e.x,i=t-e.y;return this.dmove(s,i)}function Dr(n,t,e=this.bbox()){const s=Dt(this,n,t,e),i=s.width/e.width,r=s.height/e.height;return this.children().forEach(o=>{const a=new N(e).transform(new b(o).inverse());o.scale(i,r,a.x,a.y)}),this}function Cr(n,t=this.bbox()){return n==null?t.width:this.size(n,t.height,t)}function kr(n,t=this.bbox()){return n==null?t.x:this.move(n,t.y,t)}function Mr(n,t=this.bbox()){return n==null?t.y:this.move(t.x,n,t)}const Xn=Object.freeze(Object.defineProperty({__proto__:null,dmove:vr,dx:Er,dy:Tr,height:Sr,move:Ar,size:Dr,width:Cr,x:kr,y:Mr},Symbol.toStringTag,{value:"Module"}));class ft extends X{constructor(t,e=t){super(R("g",t),e)}}x(ft,Xn);v({Container:{group:F(function(){return this.put(new ft)})}});S(ft,"G");class se extends X{constructor(t,e=t){super(R("a",t),e)}target(t){return this.attr("target",t)}to(t){return this.attr("href",t,Yt)}}x(se,Xn);v({Container:{link:F(function(n){return this.put(new se).to(n)})},Element:{unlink(){const n=this.linker();if(!n)return this;const t=n.parent();if(!t)return this.remove();const e=t.index(n);return t.add(this,e),n.remove(),this},linkTo(n){let t=this.linker();return t||(t=new se,this.wrap(t)),typeof n=="function"?n.call(t,t):t.to(n),this},linker(){const n=this.parent();return n&&n.node.nodeName.toLowerCase()==="a"?n:null}}});S(se,"A");class Ce extends X{constructor(t,e=t){super(R("mask",t),e)}remove(){return this.targets().forEach(function(t){t.unmask()}),super.remove()}targets(){return Ct("svg [mask*="+this.id()+"]")}}v({Container:{mask:F(function(){return this.defs().put(new Ce)})},Element:{masker(){return this.reference("mask")},maskWith(n){const t=n instanceof Ce?n:this.parent().mask().add(n);return this.attr("mask","url(#"+t.id()+")")},unmask(){return this.attr("mask",null)}}});S(Ce,"Mask");class Gn extends U{constructor(t,e=t){super(R("stop",t),e)}update(t){return(typeof t=="number"||t instanceof _)&&(t={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),t.opacity!=null&&this.attr("stop-opacity",t.opacity),t.color!=null&&this.attr("stop-color",t.color),t.offset!=null&&this.attr("offset",new _(t.offset)),this}}v({Gradient:{stop:function(n,t,e){return this.put(new Gn).update(n,t,e)}}});S(Gn,"Stop");function Pr(n,t){if(!n)return"";if(!t)return n;let e=n+"{";for(const s in t)e+=Ts(s)+":"+t[s]+";";return e+="}",e}class ke extends U{constructor(t,e=t){super(R("style",t),e)}addText(t=""){return this.node.textContent+=t,this}font(t,e,s={}){return this.rule("@font-face",{fontFamily:t,src:e,...s})}rule(t,e){return this.addText(Pr(t,e))}}v("Dom",{style(n,t){return this.put(new ke).rule(n,t)},fontface(n,t,e){return this.put(new ke).font(n,t,e)}});S(ke,"Style");class Qe extends et{constructor(t,e=t){super(R("textPath",t),e)}array(){const t=this.track();return t?t.array():null}plot(t){const e=this.track();let s=null;return e&&(s=e.plot(t)),t==null?s:this}track(){return this.reference("href")}}v({Container:{textPath:F(function(n,t){return n instanceof et||(n=this.text(n)),n.path(t)})},Text:{path:F(function(n,t=!0){const e=new Qe;n instanceof kt||(n=this.defs().path(n)),e.attr("href","#"+n,Yt);let s;if(t)for(;s=this.node.firstChild;)e.node.appendChild(s);return this.put(e)}),textPath(){return this.findOne("textPath")}},Path:{text:F(function(n){return n instanceof et||(n=new et().addTo(this.parent()).text(n)),n.path(this)}),targets(){return Ct("svg textPath").filter(n=>(n.attr("href")||"").includes(this.id()))}}});Qe.prototype.MorphArray=_t;S(Qe,"TextPath");class Kn extends Q{constructor(t,e=t){super(R("use",t),e)}use(t,e){return this.attr("href",(e||"")+"#"+t,Yt)}}v({Container:{use:F(function(n,t){return this.put(new Kn).use(n,t)})}});S(Kn,"Use");const Me=j;x([Ge,Ke,le,Vt,te],q("viewbox"));x([wt,vt,xt,kt],q("marker"));x(et,q("Text"));x(kt,q("Path"));x(je,q("Defs"));x([et,he],q("Tspan"));x([ue,ae,Xt,J],q("radius"));x(Ut,q("EventTarget"));x(ct,q("Dom"));x(U,q("Element"));x(Q,q("Shape"));x([X,Ln],q("Container"));x(Xt,q("Gradient"));x(J,q("Runner"));bt.extend(vs());Qi([_,k,H,b,At,dt,_t,N]);Zi();const Fr={class:"m-svg-canvas-wrapper"},Rr={__name:"index",setup(n){const t=W(null),e=W(null),s=W(null),i=W(1);let r=0,o=0;function a(){const{w:p,h:w}=g(),A=p*1.5,z=w*1.5;r=(A-$.width)/2,o=(z-$.height)/2}function l(){const p=s.value;if(p){const{w,h:A}=g(),z=p.clientWidth,O=p.clientHeight,Y=w*1.5,P=A*1.5;p.scrollLeft=(Y-z)/2,p.scrollTop=(P-O)/2}}let u=null,h=null;function c(){u.clear();const{w:p}=g(),A=Math.max(10,10*i.value),z=p*2,O=50*i.value;let Y=Math.floor(-r/O)*O;for(let P=Y;P<z-r;P+=A){const G=(P/i.value).toFixed(0),st=P%O===0,lt=st?20:10;u.line(P+r,0,P+r,lt).stroke({color:"#000",width:1}),st&&u.text(G).move(P+r+2,8).font({size:8})}}function f(){h.clear();const{h:p}=g(),A=Math.max(10,10*i.value),z=p*2,O=50*i.value;let Y=Math.floor(-o/O)*O;for(let P=Y;P<z-o;P+=A){const G=(P/i.value).toFixed(0),st=P%O===0,lt=st?20:10;if(h.line(0,P+o,lt,P+o).stroke({color:"#000",width:1}),st){let Mt=8,ss=P+o+4;["0"].includes(G)?Mt=14:["-50","50"].includes(G)&&(Mt=12),h.text(G).move(Mt,ss).font({size:8}).rotate(90)}}}function d(){const p=s.value.scrollLeft,w=s.value.scrollTop;u.attr({style:`transform: translateX(${-p}px);`}),h.attr({style:`transform: translateY(${-w}px);`})}function g(){const p=Math.max($.minWrapperWidth,$.width),w=Math.max($.minWrapperHeight,$.height);return{w:p,h:w}}return ie(()=>{setTimeout(()=>{const{w:p,h:w}=g();a(),u=Me().addTo(t.value).size(p*2,24),h=Me().addTo(e.value).size(24,w*2),c(),f(),l(),d()},300)}),L(()=>[$.width,$.height],()=>{os(()=>{const{w:p,h:w}=g();a(),c(),f(),l(),u.size(p*2,24),h.size(24,w*2),d()})}),L(i,()=>{c(),f()}),(p,w)=>(M(),V("div",Fr,[w[0]||(w[0]=C("div",{class:"ruler_corner"},null,-1)),C("div",{ref_key:"rulerXRef",ref:t,class:"ruler_x"},null,512),C("div",{ref_key:"rulerYRef",ref:e,class:"ruler_y"},null,512),C("div",{ref_key:"workareaRef",ref:s,class:"workarea",onScroll:d},[Oe(p.$slots,"default",{},void 0,!0)],544)]))}},Nr=nt(Rr,[["__scopeId","data-v-b7679166"]]),zr={__name:"index",setup(n){const t=oe(),e=W(null),s=as(()=>{const i=Math.max($.minWrapperWidth,$.width),r=Math.max($.minWrapperHeight,$.height);return{width:`${i*1.5}px`,height:`${r*1.5}px`}});return ie(()=>{e.value&&(t.initSVG(e.value),t.backgroundRenderer.draw())}),(i,r)=>(M(),V("div",{ref_key:"canvasRef",ref:e,class:"m-svg-canvas",style:ls(s.value)},null,4))}},Or=nt(zr,[["__scopeId","data-v-6c74ae1f"]]),Hr={class:"background-panel"},Lr={__name:"index",props:{target:{type:Object,required:!0}},setup(n){const t=n,e=[{label:"320*512"},{label:"380*400"},{label:"2752*56"}],s=$t({fill:"",size:"",width:"",height:""}),{target:i}=t;return s.fill=i.getFill(),s.width=i.getWidth(),s.height=i.getHeight(),s.size=`${s.width}*${s.height}`,L(()=>s.fill,r=>{i.setFill(r)}),L(()=>s.width,r=>{i.setWidth(r),be(r,s.height)}),L(()=>s.height,r=>{i.setHeight(r),be(s.width,r)}),L(()=>s.size,r=>{const[o,a]=r.split("*");s.width=o,s.height=a}),(r,o)=>(M(),V("div",Hr,[o[4]||(o[4]=C("h2",{class:"m-svg-attr-title"},"画板设计",-1)),y(m(jt),{model:s,"label-position":"left","label-width":"auto"},{default:E(()=>[y(m(I),{label:"宽"},{default:E(()=>[y(m(yt),{type:"number",modelValue:s.width,"onUpdate:modelValue":o[0]||(o[0]=a=>s.width=a),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),y(m(I),{label:"高"},{default:E(()=>[y(m(yt),{type:"number",modelValue:s.height,"onUpdate:modelValue":o[1]||(o[1]=a=>s.height=a),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),y(m(I),{label:"背景颜色"},{default:E(()=>[y(m(Nt),{modelValue:s.fill,"onUpdate:modelValue":o[2]||(o[2]=a=>s.fill=a)},null,8,["modelValue"])]),_:1}),y(m(I),{label:"常见尺寸"},{default:E(()=>[y(m(zt),{modelValue:s.size,"onUpdate:modelValue":o[3]||(o[3]=a=>s.size=a)},{default:E(()=>[(M(),V(Ot,null,Ht(e,(a,l)=>y(m(Lt),{key:l,value:a.label,label:a.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]))}},Ir=[{label:"正常",value:"normal"},{label:"粗体",value:"bold"}],Vr=[{label:"正常",value:"normal"},{label:"斜体",value:"italic"}],Br=[{value:"宋体",label:"宋体"},{value:"新宋体",label:"新宋体"},{value:"楷体",label:"楷体"},{value:"仿宋",label:"仿宋"},{value:"微软雅黑",label:"微软雅黑"},{value:"黑体",label:"黑体"}],$r=[8,9,10,11,12,14,16,18,20,22,26,28,36,48,56,64,72],jr={class:"text-panel"},Wr={__name:"index",props:{target:{type:Object,required:!0}},setup(n){const t=n,e=$t({content:"",fill:"",fontFamily:"",fontSize:"",fontWeight:"",fontStyle:""}),{target:s}=t;e.content=s.getText(),e.fontSize=s.getSize(),e.fill=s.getFill(),e.fontFamily=s.getFontFamily(),e.fontWeight=s.getWeight(),e.fontStyle=s.getFontStyle();function i(o){return/^\$\{.*\}$/.test(o)}const r=i(e.content);return L(()=>e.content,o=>{s.setText(o)}),L(()=>e.fontSize,o=>{s.setSize(o)}),L(()=>e.fill,o=>{s.setFill(o)}),L(()=>e.fontWeight,o=>{s.setWeight(o)}),L(()=>e.fontStyle,o=>{s.setFontStyle(o)}),L(()=>e.fontFamily,o=>{s.setFontFamily(`${o}`)}),Wt(()=>{s.deselectAll()}),(o,a)=>(M(),V("div",jr,[a[6]||(a[6]=C("h2",{class:"m-svg-attr-title"},"文字",-1)),y(m(jt),{model:e,"label-position":"left","label-width":"auto"},{default:E(()=>[m(r)?re("",!0):(M(),it(m(I),{key:0,label:"内容"},{default:E(()=>[y(m(yt),{modelValue:e.content,"onUpdate:modelValue":a[0]||(a[0]=l=>e.content=l),placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})),y(m(I),{label:"字体粗细"},{default:E(()=>[y(m(tn),{modelValue:e.fontWeight,"onUpdate:modelValue":a[1]||(a[1]=l=>e.fontWeight=l),options:m(Ir)},null,8,["modelValue","options"])]),_:1}),y(m(I),{label:"字体字形"},{default:E(()=>[y(m(tn),{modelValue:e.fontStyle,"onUpdate:modelValue":a[2]||(a[2]=l=>e.fontStyle=l),options:m(Vr)},null,8,["modelValue","options"])]),_:1}),y(m(I),{label:"字体大小"},{default:E(()=>[y(m(zt),{modelValue:e.fontSize,"onUpdate:modelValue":a[3]||(a[3]=l=>e.fontSize=l),placeholder:"请选择字体大小"},{default:E(()=>[(M(!0),V(Ot,null,Ht(m($r),(l,u)=>(M(),it(m(Lt),{key:u,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),y(m(I),{label:"文本字体"},{default:E(()=>[y(m(zt),{modelValue:e.fontFamily,"onUpdate:modelValue":a[4]||(a[4]=l=>e.fontFamily=l),placeholder:"请选择字体"},{default:E(()=>[(M(!0),V(Ot,null,Ht(m(Br),(l,u)=>(M(),it(m(Lt),{key:u,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),y(m(I),{label:"文本颜色"},{default:E(()=>[y(m(Nt),{modelValue:e.fill,"onUpdate:modelValue":a[5]||(a[5]=l=>e.fill=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]))}},Yr={},qr={class:"table-panel"};function Ur(n,t){return M(),V("div",qr,t[0]||(t[0]=[C("h2",{class:"m-svg-attr-title"},"表格",-1)]))}const Xr=nt(Yr,[["render",Ur]]),Gr=[{label:"—",value:0},{label:"···",value:"2,2"},{label:"- -",value:"5,5"},{label:"-·-",value:"5,2,2,2"},{label:"-··-",value:"5,2,2,2,2,2"}],Kr={class:"line-panel"},Jr={__name:"index",props:{target:{type:Object,required:!0}},setup(n){const t=n,e=$t({color:"",strokeWidth:"",strokeDasharray:""}),{target:s}=t;return e.color=s.getColor(),e.strokeWidth=s.getStrokeWidth(),e.strokeDasharray=s.getStrokeDasharray(),L(()=>e.color,i=>{s.setColor(i)}),L(()=>e.strokeWidth,i=>{s.setStrokeWidth(i)}),L(()=>e.strokeDasharray,i=>{s.setStrokeDasharray(i)}),Wt(()=>{s.deselectAll()}),(i,r)=>(M(),V("div",Kr,[r[3]||(r[3]=C("h2",{class:"m-svg-attr-title"},"直线",-1)),y(m(jt),{model:e,"label-position":"left","label-width":"auto"},{default:E(()=>[y(m(I),{label:"线宽"},{default:E(()=>[y(m(yt),{modelValue:e.strokeWidth,"onUpdate:modelValue":r[0]||(r[0]=o=>e.strokeWidth=o)},null,8,["modelValue"])]),_:1}),y(m(I),{label:"点画"},{default:E(()=>[y(m(zt),{modelValue:e.strokeDasharray,"onUpdate:modelValue":r[1]||(r[1]=o=>e.strokeDasharray=o),placeholder:"请选择点画"},{default:E(()=>[(M(!0),V(Ot,null,Ht(m(Gr),(o,a)=>(M(),it(m(Lt),{key:a,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),y(m(I),{label:"颜色"},{default:E(()=>[y(m(Nt),{modelValue:e.color,"onUpdate:modelValue":r[2]||(r[2]=o=>e.color=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]))}},Qr=[{label:"—",value:0},{label:"···",value:"2,2"},{label:"- -",value:"5,5"},{label:"-·-",value:"5,2,2,2"},{label:"-··-",value:"5,2,2,2,2,2"}],Zr={class:"rect-panel"},to={__name:"index",props:{target:{type:Object,required:!0}},setup(n){const t=n,e=$t({fill:"",color:"",strokeWidth:"",strokeDasharray:""}),{target:s}=t;return e.fill=s.getFill(),e.color=s.getColor(),e.strokeWidth=s.getStrokeWidth(),e.strokeDasharray=s.getStrokeDasharray(),L(()=>e.fill,i=>{s.setFill(i)}),L(()=>e.color,i=>{s.setColor(i)}),L(()=>e.strokeWidth,i=>{s.setStrokeWidth(i)}),L(()=>e.strokeDasharray,i=>{s.setStrokeDasharray(i)}),Wt(()=>{s.deselectAll()}),(i,r)=>(M(),V("div",Zr,[r[4]||(r[4]=C("h2",{class:"m-svg-attr-title"},"矩形",-1)),y(m(jt),{model:e,"label-position":"left","label-width":"auto"},{default:E(()=>[y(m(I),{label:"线宽"},{default:E(()=>[y(m(yt),{modelValue:e.strokeWidth,"onUpdate:modelValue":r[0]||(r[0]=o=>e.strokeWidth=o)},null,8,["modelValue"])]),_:1}),y(m(I),{label:"点画"},{default:E(()=>[y(m(zt),{modelValue:e.strokeDasharray,"onUpdate:modelValue":r[1]||(r[1]=o=>e.strokeDasharray=o),placeholder:"请选择点画"},{default:E(()=>[(M(!0),V(Ot,null,Ht(m(Qr),(o,a)=>(M(),it(m(Lt),{key:a,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),y(m(I),{label:"背景颜色"},{default:E(()=>[y(m(Nt),{modelValue:e.fill,"onUpdate:modelValue":r[2]||(r[2]=o=>e.fill=o)},null,8,["modelValue"])]),_:1}),y(m(I),{label:"边框颜色"},{default:E(()=>[y(m(Nt),{modelValue:e.color,"onUpdate:modelValue":r[3]||(r[3]=o=>e.color=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]))}},eo={"background-panel":Lr,"text-panel":Wr,"line-panel":Jr,"rect-panel":to,"table-panel":Xr},no={class:"m-svg-attr"},so={__name:"index",setup(n){const t=oe(),e=W(""),s=W(""),i=W(null);function r({type:o,target:a,id:l}){e.value=o,s.value=l,i.value=a}return t.emitter.on(t.emitter_type.SELECT_ELEMENT,r),t.emitter.on(t.emitter_type.ELEMENT_CLEARED,()=>{e.value="",s.value="",i.value=null}),(o,a)=>(M(),V("div",no,[i.value!==null?(M(),it(us(m(eo)[e.value]),{target:i.value,key:s.value},null,8,["target"])):re("",!0)]))}},io=nt(so,[["__scopeId","data-v-08eba021"]]),ot={TEXT_PANEL:"text-panel",BACKGROUND_PANEL:"background-panel",LINE_PANEL:"line-panel",RECT_PANEL:"rect-panel"};function ce(){return"editor-xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const t=Math.random()*16|0;return(n==="x"?t:t&3|8).toString(16)})}const ro={class:"layer-manager"},oo={class:"layer-manager-tree-node"},ao={__name:"index",setup(n){const t=W(null),e=oe(),s=W(""),i={children:"children",label:"label"};function r({id:u,label:h,type:c,target:f,el:d}){const g={id:u,label:h,type:c,target:f,el:d,children:[]};if(ut.value.length){const[p]=ut.value;p.children.push(g)}else ut.value.push(g)}function o({id:u,target:h}){const c=t.value.getNode(u);if(c&&(t.value.remove(c),h.deselectAll(),h.remove(),e.emitter.emit(e.emitter_type.DELAYER,{id:u}),s.value===u)){const[f]=ut.value;f.target.select()}}function a({id:u}){s.value=u,t.value.setCurrentKey(u)}function l(u){s.value=u.id,u.target.select()}return e.emitter.on(e.emitter_type.ELEMENT_CREATED,r),e.emitter.on(e.emitter_type.ELEMENT_CLEARED,bn),e.emitter.on(e.emitter_type.SELECT_ELEMENT,a),(u,h)=>(M(),V("div",ro,[h[1]||(h[1]=C("h2",{class:"layer-manager-title"},"图层",-1)),y(m(pn),{ref_key:"treeRef",ref:t,"node-key":"id","highlight-current":"","default-expand-all":"",data:m(ut),props:i,"expand-on-click-node":!1,onCurrentChange:l},{default:E(({node:c,data:f})=>[C("span",oo,[C("span",null,hs(c.label),1),[m(ot).BACKGROUND_PANEL].includes(f.type)?re("",!0):(M(),it(m(cs),{key:0,type:"danger",onClick:ds(d=>o(f),["stop"])},{default:E(()=>h[0]||(h[0]=[Ft("删除")])),_:2},1032,["onClick"]))])]),_:1},8,["data"])]))}},lo=nt(ao,[["__scopeId","data-v-ae944007"]]),K={INIT_SVGCANVAS:"INIT_SVGCANVAS",SELECT_ELEMENT:"CANVAS:SELECT_ELEMENT",ELEMENT_CREATED:"CANVAS:ELEMENT_CREATED",ELEMENT_CLEARED:"CANVAS:ELEMENT_CLEARED",DRAG_DROP:"CANVAS:DRAG_DROP",UPDATE_CANVAS_WRAPPER:"CANVAS:UPDATE_CANVAS_WRAPPER",DELAYER:"CANVAS:DELAYER"},hn=n=>(n.changedTouches&&(n=n.changedTouches[0]),{x:n.clientX,y:n.clientY});class uo{constructor(t){t.remember("_draggable",this),this.el=t,this.drag=this.drag.bind(this),this.startDrag=this.startDrag.bind(this),this.endDrag=this.endDrag.bind(this)}init(t){t?(this.el.on("mousedown.drag",this.startDrag),this.el.on("touchstart.drag",this.startDrag,{passive:!1})):(this.el.off("mousedown.drag"),this.el.off("touchstart.drag"))}startDrag(t){const e=!t.type.indexOf("mouse");if(e&&t.which!==1&&t.buttons!==0||this.el.dispatch("beforedrag",{event:t,handler:this}).defaultPrevented)return;t.preventDefault(),t.stopPropagation(),this.init(!1),this.box=this.el.bbox(),this.lastClick=this.el.point(hn(t));const s=(e?"mousemove":"touchmove")+".drag",i=(e?"mouseup":"touchend")+".drag";rt(window,s,this.drag,this,{passive:!1}),rt(window,i,this.endDrag,this,{passive:!1}),this.el.fire("dragstart",{event:t,handler:this,box:this.box})}drag(t){const{box:e,lastClick:s}=this,i=this.el.point(hn(t)),r=i.x-s.x,o=i.y-s.y;if(!r&&!o)return e;const a=e.x+r,l=e.y+o;this.box=new H(a,l,e.w,e.h),this.lastClick=i,!this.el.dispatch("dragmove",{event:t,handler:this,box:this.box}).defaultPrevented&&this.move(a,l)}move(t,e){this.el.type==="svg"?ft.prototype.move.call(this.el,t,e):this.el.move(t,e)}endDrag(t){this.drag(t),this.el.fire("dragend",{event:t,handler:this,box:this.box}),tt(window,"mousemove.drag"),tt(window,"touchmove.drag"),tt(window,"mouseup.drag"),tt(window,"touchend.drag"),this.init(!0)}}x(U,{draggable(n=!0){return(this.remember("_draggable")||new uo(this)).init(n),this}});/*!
* @svgdotjs/svg.select.js - An extension of svg.js which allows to select elements with mouse
* @version 4.0.1
* https://github.com/svgdotjs/svg.select.js
*
* @copyright Ulrich-Matthias Schäfer
* @license MIT
*
* BUILT: Mon Jul 01 2024 15:04:42 GMT+0200 (Central European Summer Time)
*/function Pe(n,t,e,s=null){return function(i){i.preventDefault(),i.stopPropagation();var r=i.pageX||i.touches[0].pageX,o=i.pageY||i.touches[0].pageY;t.fire(n,{x:r,y:o,event:i,index:s,points:e})}}function Fe([n,t],{a:e,b:s,c:i,d:r,e:o,f:a}){return[n*e+t*i+o,n*s+t*r+a]}let Jn=class{constructor(t){this.el=t,t.remember("_selectHandler",this),this.selection=new ft,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const e=qt();this.observer=new e.MutationObserver(this.mutationHandler)}init(t){this.createHandle=t.createHandle||this.createHandleFn,this.createRot=t.createRot||this.createRotFn,this.updateHandle=t.updateHandle||this.updateHandleFn,this.updateRot=t.updateRot||this.updateRotFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createResizeHandles(),this.updateResizeHandles(),this.createRotationHandle(),this.updateRotationHandle(),this.observer.observe(this.el.node,{attributes:!0})}active(t,e){if(!t){this.selection.clear().remove(),this.observer.disconnect();return}this.init(e)}createSelection(){this.selection.polygon(this.handlePoints).addClass("svg_select_shape")}updateSelection(){this.selection.get(0).plot(this.handlePoints)}createResizeHandles(){this.handlePoints.forEach((t,e,s)=>{const i=this.order[e];this.createHandle.call(this,this.selection,t,e,s,i),this.selection.get(e+1).addClass("svg_select_handle svg_select_handle_"+i).on("mousedown.selection touchstart.selection",Pe(i,this.el,this.handlePoints,e))})}createHandleFn(t){t.polyline()}updateHandleFn(t,e,s,i){const r=i.at(s-1),o=i[(s+1)%i.length],a=e,l=[a[0]-r[0],a[1]-r[1]],u=[a[0]-o[0],a[1]-o[1]],h=Math.sqrt(l[0]*l[0]+l[1]*l[1]),c=Math.sqrt(u[0]*u[0]+u[1]*u[1]),f=[l[0]/h,l[1]/h],d=[u[0]/c,u[1]/c],g=[a[0]-f[0]*10,a[1]-f[1]*10],p=[a[0]-d[0]*10,a[1]-d[1]*10];t.plot([g,a,p])}updateResizeHandles(){this.handlePoints.forEach((t,e,s)=>{const i=this.order[e];this.updateHandle.call(this,this.selection.get(e+1),t,e,s,i)})}createRotFn(t){t.line(),t.circle(5)}getPoint(t){return this.handlePoints[this.order.indexOf(t)]}getPointHandle(t){return this.selection.get(this.order.indexOf(t)+1)}updateRotFn(t,e){const s=this.getPoint("t");t.get(0).plot(s[0],s[1],e[0],e[1]),t.get(1).center(e[0],e[1])}createRotationHandle(){const t=this.selection.group().addClass("svg_select_handle_rot").on("mousedown.selection touchstart.selection",Pe("rot",this.el,this.handlePoints));this.createRot.call(this,t)}updateRotationHandle(){const t=this.selection.findOne("g.svg_select_handle_rot");this.updateRot(t,this.rotationPoint,this.handlePoints)}updatePoints(){const t=this.el.bbox(),e=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.handlePoints=this.getHandlePoints(t).map(s=>Fe(s,e)),this.rotationPoint=Fe(this.getRotationPoint(t),e)}getHandlePoints({x:t,x2:e,y:s,y2:i,cx:r,cy:o}=this.el.bbox()){return[[t,s],[r,s],[e,s],[e,o],[e,i],[r,i],[t,i],[t,o]]}getRotationPoint({y:t,cx:e}=this.el.bbox()){return[e,t-20]}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updateResizeHandles(),this.updateRotationHandle()}},ho=class{constructor(t){this.el=t,t.remember("_pointSelectHandler",this),this.selection=new ft,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const e=qt();this.observer=new e.MutationObserver(this.mutationHandler)}init(t){this.createHandle=t.createHandle||this.createHandleFn,this.updateHandle=t.updateHandle||this.updateHandleFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createPointHandles(),this.updatePointHandles(),this.observer.observe(this.el.node,{attributes:!0})}active(t,e){if(!t){this.selection.clear().remove(),this.observer.disconnect();return}this.init(e)}createSelection(){this.selection.polygon(this.points).addClass("svg_select_shape_pointSelect")}updateSelection(){this.selection.get(0).plot(this.points)}createPointHandles(){this.points.forEach((t,e,s)=>{this.createHandle.call(this,this.selection,t,e,s),this.selection.get(e+1).addClass("svg_select_handle_point").on("mousedown.selection touchstart.selection",Pe("point",this.el,this.points,e))})}createHandleFn(t){t.circle(5)}updateHandleFn(t,e){t.center(e[0],e[1])}updatePointHandles(){this.points.forEach((t,e,s)=>{this.updateHandle.call(this,this.selection.get(e+1),t,e,s)})}updatePoints(){const t=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.points=this.el.array().map(e=>Fe(e,t))}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updatePointHandles()}};const Qn=n=>function(t=!0,e={}){typeof t=="object"&&(e=t,t=!0);let s=this.remember("_"+n.name);return s||(t.prototype instanceof Jn?(s=new t(this),t=!0):s=new n(this),this.remember("_"+n.name,s)),s.active(t,e),this};x(U,{select:Qn(Jn)});x([xt,vt,wt],{pointSelect:Qn(ho)});/*!
* @svgdotjs/svg.resize.js - An extension for svg.js which allows to resize elements which are selected
* @version 2.0.4
* https://github.com/svgdotjs/svg.resize.js
*
* @copyright [object Object]
* @license MIT
*
* BUILT: Fri Sep 13 2024 12:43:14 GMT+0200 (Central European Summer Time)
*//*!
* @svgdotjs/svg.select.js - An extension of svg.js which allows to select elements with mouse
* @version 4.0.1
* https://github.com/svgdotjs/svg.select.js
*
* @copyright Ulrich-Matthias Schäfer
* @license MIT
*
* BUILT: Mon Jul 01 2024 15:04:42 GMT+0200 (Central European Summer Time)
*/function Re(n,t,e,s=null){return function(i){i.preventDefault(),i.stopPropagation();var r=i.pageX||i.touches[0].pageX,o=i.pageY||i.touches[0].pageY;t.fire(n,{x:r,y:o,event:i,index:s,points:e})}}function Ne([n,t],{a:e,b:s,c:i,d:r,e:o,f:a}){return[n*e+t*i+o,n*s+t*r+a]}class Zn{constructor(t){this.el=t,t.remember("_selectHandler",this),this.selection=new ft,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const e=qt();this.observer=new e.MutationObserver(this.mutationHandler)}init(t){this.createHandle=t.createHandle||this.createHandleFn,this.createRot=t.createRot||this.createRotFn,this.updateHandle=t.updateHandle||this.updateHandleFn,this.updateRot=t.updateRot||this.updateRotFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createResizeHandles(),this.updateResizeHandles(),this.createRotationHandle(),this.updateRotationHandle(),this.observer.observe(this.el.node,{attributes:!0})}active(t,e){if(!t){this.selection.clear().remove(),this.observer.disconnect();return}this.init(e)}createSelection(){this.selection.polygon(this.handlePoints).addClass("svg_select_shape")}updateSelection(){this.selection.get(0).plot(this.handlePoints)}createResizeHandles(){this.handlePoints.forEach((t,e,s)=>{const i=this.order[e];this.createHandle.call(this,this.selection,t,e,s,i),this.selection.get(e+1).addClass("svg_select_handle svg_select_handle_"+i).on("mousedown.selection touchstart.selection",Re(i,this.el,this.handlePoints,e))})}createHandleFn(t){t.polyline()}updateHandleFn(t,e,s,i){const r=i.at(s-1),o=i[(s+1)%i.length],a=e,l=[a[0]-r[0],a[1]-r[1]],u=[a[0]-o[0],a[1]-o[1]],h=Math.sqrt(l[0]*l[0]+l[1]*l[1]),c=Math.sqrt(u[0]*u[0]+u[1]*u[1]),f=[l[0]/h,l[1]/h],d=[u[0]/c,u[1]/c],g=[a[0]-f[0]*10,a[1]-f[1]*10],p=[a[0]-d[0]*10,a[1]-d[1]*10];t.plot([g,a,p])}updateResizeHandles(){this.handlePoints.forEach((t,e,s)=>{const i=this.order[e];this.updateHandle.call(this,this.selection.get(e+1),t,e,s,i)})}createRotFn(t){t.line(),t.circle(5)}getPoint(t){return this.handlePoints[this.order.indexOf(t)]}getPointHandle(t){return this.selection.get(this.order.indexOf(t)+1)}updateRotFn(t,e){const s=this.getPoint("t");t.get(0).plot(s[0],s[1],e[0],e[1]),t.get(1).center(e[0],e[1])}createRotationHandle(){const t=this.selection.group().addClass("svg_select_handle_rot").on("mousedown.selection touchstart.selection",Re("rot",this.el,this.handlePoints));this.createRot.call(this,t)}updateRotationHandle(){const t=this.selection.findOne("g.svg_select_handle_rot");this.updateRot(t,this.rotationPoint,this.handlePoints)}updatePoints(){const t=this.el.bbox(),e=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.handlePoints=this.getHandlePoints(t).map(s=>Ne(s,e)),this.rotationPoint=Ne(this.getRotationPoint(t),e)}getHandlePoints({x:t,x2:e,y:s,y2:i,cx:r,cy:o}=this.el.bbox()){return[[t,s],[r,s],[e,s],[e,o],[e,i],[r,i],[t,i],[t,o]]}getRotationPoint({y:t,cx:e}=this.el.bbox()){return[e,t-20]}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updateResizeHandles(),this.updateRotationHandle()}}class co{constructor(t){this.el=t,t.remember("_pointSelectHandler",this),this.selection=new ft,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const e=qt();this.observer=new e.MutationObserver(this.mutationHandler)}init(t){this.createHandle=t.createHandle||this.createHandleFn,this.updateHandle=t.updateHandle||this.updateHandleFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createPointHandles(),this.updatePointHandles(),this.observer.observe(this.el.node,{attributes:!0})}active(t,e){if(!t){this.selection.clear().remove(),this.observer.disconnect();return}this.init(e)}createSelection(){this.selection.polygon(this.points).addClass("svg_select_shape_pointSelect")}updateSelection(){this.selection.get(0).plot(this.points)}createPointHandles(){this.points.forEach((t,e,s)=>{this.createHandle.call(this,this.selection,t,e,s),this.selection.get(e+1).addClass("svg_select_handle_point").on("mousedown.selection touchstart.selection",Re("point",this.el,this.points,e))})}createHandleFn(t){t.circle(5)}updateHandleFn(t,e){t.center(e[0],e[1])}updatePointHandles(){this.points.forEach((t,e,s)=>{this.updateHandle.call(this,this.selection.get(e+1),t,e,s)})}updatePoints(){const t=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.points=this.el.array().map(e=>Ne(e,t))}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updatePointHandles()}}const ts=n=>function(t=!0,e={}){typeof t=="object"&&(e=t,t=!0);let s=this.remember("_"+n.name);return s||(t.prototype instanceof Zn?(s=new t(this),t=!0):s=new n(this),this.remember("_"+n.name,s)),s.active(t,e),this};x(U,{select:ts(Zn)});x([xt,vt,wt],{pointSelect:ts(co)});const Qt=n=>(n.changedTouches&&(n=n.changedTouches[0]),{x:n.clientX,y:n.clientY}),es=n=>{let t=1/0,e=1/0,s=-1/0,i=-1/0;for(let r=0;r<n.length;r++){const o=n[r];t=Math.min(t,o[0]),e=Math.min(e,o[1]),s=Math.max(s,o[0]),i=Math.max(i,o[1])}return new H(t,e,s-t,i-e)};function fo(n,t,e){const i=[[n.x,n.y],[n.x+n.width,n.y],[n.x+n.width,n.y+n.height],[n.x,n.y+n.height]].map(([r,o])=>{const a=r-t[0],l=o-t[1],u=a*e,h=l*e;return[u+t[0],h+t[1]]});return es(i)}class cn{constructor(t){this.el=t,t.remember("_ResizeHandler",this),this.lastCoordinates=null,this.eventType="",this.lastEvent=null,this.handleResize=this.handleResize.bind(this),this.resize=this.resize.bind(this),this.endResize=this.endResize.bind(this),this.rotate=this.rotate.bind(this),this.movePoint=this.movePoint.bind(this)}active(t,e){this.preserveAspectRatio=e.preserveAspectRatio??!1,this.aroundCenter=e.aroundCenter??!1,this.grid=e.grid??0,this.degree=e.degree??0,this.el.off(".resize"),t&&(this.el.on(["lt.resize","rt.resize","rb.resize","lb.resize","t.resize","r.resize","b.resize","l.resize","rot.resize","point.resize"],this.handleResize),this.lastEvent&&(this.eventType==="rot"?this.rotate(this.lastEvent):this.eventType==="point"?this.movePoint(this.lastEvent):this.resize(this.lastEvent)))}handleResize(t){this.eventType=t.type;const{event:e,index:s,points:i}=t.detail,r=!e.type.indexOf("mouse");if(r&&(e.which||e.buttons)!==1||this.el.dispatch("beforeresize",{event:t,handler:this}).defaultPrevented)return;this.box=this.el.bbox(),this.startPoint=this.el.point(Qt(e)),this.index=s,this.points=i.slice();const o=(r?"mousemove":"touchmove")+".resize",a=(r?"mouseup":"touchcancel.resize touchend")+".resize";t.type==="point"?rt(window,o,this.movePoint):t.type==="rot"?rt(window,o,this.rotate):rt(window,o,this.resize),rt(window,a,this.endResize)}resize(t){this.lastEvent=t;const e=this.snapToGrid(this.el.point(Qt(t)));let s=e.x-this.startPoint.x,i=e.y-this.startPoint.y;this.preserveAspectRatio&&this.aroundCenter&&(s*=2,i*=2);const r=this.box.x+s,o=this.box.y+i,a=this.box.x2+s,l=this.box.y2+i;let u=new H(this.box);if(this.eventType.includes("l")&&(u.x=Math.min(r,this.box.x2),u.x2=Math.max(r,this.box.x2)),this.eventType.includes("r")&&(u.x=Math.min(a,this.box.x),u.x2=Math.max(a,this.box.x)),this.eventType.includes("t")&&(u.y=Math.min(o,this.box.y2),u.y2=Math.max(o,this.box.y2)),this.eventType.includes("b")&&(u.y=Math.min(l,this.box.y),u.y2=Math.max(l,this.box.y)),u.width=u.x2-u.x,u.height=u.y2-u.y,this.preserveAspectRatio){const h=u.width/this.box.width,c=u.height/this.box.height,f=["lt","t","rt","r","rb","b","lb","l"],d=(f.indexOf(this.eventType)+4)%f.length,g=this.aroundCenter?[this.box.cx,this.box.cy]:this.points[d];let p=this.eventType.includes("t")||this.eventType.includes("b")?c:h;p=this.eventType.length===2?Math.max(h,c):p,u=fo(this.box,g,p)}this.el.dispatch("resize",{box:new H(u),angle:0,eventType:this.eventType,event:t,handler:this}).defaultPrevented||this.el.size(u.width,u.height).move(u.x,u.y)}movePoint(t){this.lastEvent=t;const{x:e,y:s}=this.snapToGrid(this.el.point(Qt(t))),i=this.el.array().slice();i[this.index]=[e,s],!this.el.dispatch("resize",{box:es(i),angle:0,eventType:this.eventType,event:t,handler:this}).defaultPrevented&&this.el.plot(i)}rotate(t){this.lastEvent=t;const e=this.startPoint,s=this.el.point(Qt(t)),{cx:i,cy:r}=this.box,o=e.x-i,a=e.y-r,l=s.x-i,u=s.y-r,h=Math.sqrt(o*o+a*a)*Math.sqrt(l*l+u*u);if(h===0)return;let c=Math.acos((o*l+a*u)/h)/Math.PI*180;if(!c)return;s.x<e.x&&(c=-c);const f=new b(this.el),{x:d,y:g}=new N(i,r).transformO(f),{rotate:p}=f.decompose(),w=this.snapToAngle(p+c)-p;this.el.dispatch("resize",{box:this.box,angle:w,eventType:this.eventType,event:t,handler:this}).defaultPrevented||this.el.transform(f.rotateO(w,d,g))}endResize(t){this.eventType!=="rot"&&this.eventType!=="point"&&this.resize(t),this.lastEvent=null,this.eventType="",tt(window,"mousemove.resize touchmove.resize"),tt(window,"mouseup.resize touchend.resize")}snapToGrid(t){return this.grid&&(t.x=Math.round(t.x/this.grid)*this.grid,t.y=Math.round(t.y/this.grid)*this.grid),t}snapToAngle(t){return this.degree&&(t=Math.round(t/this.degree)*this.degree),t}}x(U,{resize:function(n=!0,t={}){typeof n=="object"&&(t=n,n=!0);let e=this.remember("_ResizeHandler");return e||(n.prototype instanceof cn?(e=new n(this),n=!0):e=new cn(this),this.remember("_resizeHandler",e)),e.active(n,t),this}});class po{constructor(t,e){B(this,"canvas",null);B(this,"emitter",null);this.canvas=t,this.emitter=e}createElementHandler(t){const{canvas:e}=this;return{type:ot.BACKGROUND_PANEL,label:"背景",id:t.id(),el:t,target:{setId(s){t.id(s)},getFill(){return t.fill()},setFill(s){t.fill(s)},getWidth(){return e.width()},setWidth(s){e.width(s)},getHeight(){return e.height()},setHeight(s){e.height(s)},select:null}}}draw(t={}){const{canvas:e,emitter:s}=this,i=e.rect("100%","100%");if(i.attr({fill:"#fff"}),t.id)i.id(t.id);else{const a=ce();i.id(a)}const r=this.createElementHandler(i),o=()=>{s.emit(K.SELECT_ELEMENT,r)};return r.target.select=o,o(),i.on("click",o),s.emit(K.ELEMENT_CREATED,r),r}}class mo{constructor(t,e){B(this,"canvas",null);B(this,"emitter",null);this.canvas=t,this.emitter=e}updateSelectBox(t){t.select(!1),t.select({createHandle:(e,s,i,r,o)=>e.circle(0),updateHandle:(e,s,i,r,o)=>e.center(s[0],s[1])})}createElementHandler(t){const e=this;return{type:ot.TEXT_PANEL,label:"文字标签",id:t.id(),el:t,target:{isSelect:!1,setId(s){t.id(s)},getX(){return t.attr("x")},setX(s){t.attr("x",s)},getY(){return t.attr("y")},setY(s){t.attr("y",s)},getFill(){return t.fill()},setFill(s){t.fill(s)},getText(){return t.text()},setText(s){t.text(s),e.updateSelectBox(t)},getSize(){return t.font("size")},setSize(s){t.font({size:s||0})},getWeight(){return t.font("weight")},setWeight(s){t.font({weight:s})},getFontStyle(){return t.font("style")},setFontStyle(s){t.font({style:s})},getFontFamily(){return t.font("family")},setFontFamily(s){t.font({family:s})},remove(){t.remove()},deselectAll(){this.isSelect&&(this.isSelect=!1,t.select(!1),t.resize(!1))},select:null}}}addText(t,e,s,i={}){const{canvas:r,emitter:o}=this,a=r.text(s).move(t,e).font({size:i.size||16,fill:i.color||"#000",weight:i.weight||"normal",style:i.style||"normal",family:i.family||"宋体"});if(i.id)a.id(i.id);else{const h=ce();a.id(h)}a.draggable();const l=this.createElementHandler(a),u=()=>{l.target.isSelect||(l.target.isSelect=!0,a.select({createHandle:(h,c,f,d,g)=>h.circle(0),updateHandle:(h,c,f,d,g)=>h.center(c[0],c[1])}),a.resize()),o.emit(K.SELECT_ELEMENT,l)};return l.target.select=u,a.on("dragstart",u),a.on("click",u),o.emit(K.ELEMENT_CREATED,l),l}}class go{constructor(t,e){B(this,"canvas",null);B(this,"emitter",null);this.canvas=t,this.emitter=e}updateSelectBox(t){t.select(!1),t.select({createHandle:(e,s,i,r,o)=>e.circle(0),updateHandle:(e,s,i,r,o)=>e.center(s[0],s[1])})}createElementHandler(t){return{type:ot.LINE_PANEL,label:"直线",id:t.id(),el:t,target:{isSelect:!1,setId(e){t.id(e)},getPlot(){return t.plot().flat()},setPlot(e,s,i,r){t.plot(e,s,i,r)},getColor(){return t.stroke()},setColor(e){t.stroke(e)},getStrokeWidth(){return t.attr("stroke-width")},setStrokeWidth(e){t.stroke({width:e})},getStrokeDasharray(){return t.attr("stroke-dasharray")},setStrokeDasharray(e){t.stroke({dasharray:e})},getTransform(){return t.attr("transform")},setTransform(e){t.attr("transform",e)},remove(){t.remove()},deselectAll(){this.isSelect&&(this.isSelect=!1,t.select(!1),t.resize(!1))},select:null}}}addLine(t,e,s,i,r={}){const{canvas:o,emitter:a}=this,l=o.line(t,e,s,i).stroke({width:r.width||1,color:r.color||"#000000",dasharray:r.dasharray||"0"});if(r.id)l.id(r.id);else{const c=ce();l.id(c)}l.draggable();const u=this.createElementHandler(l),h=()=>{u.target.isSelect||(u.target.isSelect=!0,l.select({createHandle:(c,f,d,g,p)=>[3,7].includes(d)?c.circle(1):c.circle(0),updateHandle:(c,f,d,g,p)=>c.center(f[0],f[1])}),l.resize()),a.emit(K.SELECT_ELEMENT,u)};return u.target.select=h,l.on("dragstart",h),l.on("click",h),a.emit(K.ELEMENT_CREATED,u),u}}class yo{constructor(t,e){B(this,"canvas",null);B(this,"emitter",null);this.canvas=t,this.emitter=e}createElementHandler(t){return{type:ot.RECT_PANEL,label:"距形",id:t.id(),el:t,target:{setId(e){t.id(e)},getX(){return t.attr("x")},setX(e){t.attr("x",e)},getY(){return t.attr("y")},setY(e){t.attr("y",e)},getFill(){return t.fill()},setFill(e){t.fill(e)},getColor(){return t.stroke()},setColor(e){t.stroke(e)},getWidth(){return t.width()},setWidth(e){t.width(e)},getHeight(){return t.height()},setHeight(e){t.height(e)},getStrokeWidth(){return t.attr("stroke-width")},setStrokeWidth(e){t.stroke({width:e})},getStrokeDasharray(){return t.attr("stroke-dasharray")},setStrokeDasharray(e){t.stroke({dasharray:e})},getTransform(){return t.attr("transform")},setTransform(e){t.attr("transform",e)},remove(){t.remove()},deselectAll(){this.isSelect&&(this.isSelect=!1,t.select(!1),t.resize(!1))},select:null}}}addRect(t,e,s,i,r={}){const{canvas:o,emitter:a}=this,l=o.rect(s,i).move(t,e).attr({fill:r.fill||"#fff"}).stroke({color:r.color||"#000",width:r.width||1,dasharray:r.dasharray||"0"});if(r.id)l.id(r.id);else{const c=ce();l.id(c)}l.draggable();const u=this.createElementHandler(l),h=()=>{u.target.isSelect||(u.target.isSelect=!0,l.select(),l.resize()),a.emit(K.SELECT_ELEMENT,u)};return u.target.select=h,l.on("dragstart",h),l.on("click",h),a.emit(K.ELEMENT_CREATED,u),u}}class bo{constructor(t={}){B(this,"options",{w:320,h:512});B(this,"emitter",new ms);B(this,"emitter_type",K);B(this,"canvas",null);B(this,"backgroundRenderer",null);B(this,"textManager",null);B(this,"lineManager",null);B(this,"rectManager",null);this.options={...this.options,...t}}clearCanvas(){this.canvas&&(this.canvas.clear(),this.emitter.emit(K.ELEMENT_CLEARED))}saveCanvasText(){if(this.canvas)return this.canvas.svg()}initSVG(t){if(t){this.canvas=Me();const{w:e,h:s}=this.options;this.canvas.addTo(t).size(e,s),this.backgroundRenderer=new po(this.canvas,this.emitter),this.textManager=new mo(this.canvas,this.emitter),this.lineManager=new go(this.canvas,this.emitter),this.rectManager=new yo(this.canvas,this.emitter),this.emitter.emit(K.INIT_SVGCANVAS),this.setupDragAndDrop()}else console.error("SVGCanvas 需要一个有效的 DOM 元素来初始化画布。")}render(t){const e=JSON.parse(t);this.clearCanvas(),setTimeout(()=>this.processAST(e),300)}processAST(t){t.forEach(e=>{this.handleNode(e),e.children&&e.children.length>0&&this.processAST(e.children)})}handleNode(t){const e=this;switch(t.type){case ot.BACKGROUND_PANEL:{const{fill:s,height:i,width:r}=t.attr,o=this.backgroundRenderer.draw({id:t.id});o.target.setWidth(r),o.target.setHeight(i),o.target.setFill(s),e.emitter.emit(K.UPDATE_CANVAS_WRAPPER,{width:r,height:i});break}case ot.TEXT_PANEL:{const{x:s,y:i,content:r,fontSize:o,fill:a,fontFamily:l,fontWeight:u,fontStyle:h}=t.attr,c=this.textManager.addText(s,i,r,{size:o,color:a,family:l,weight:u,style:h,id:t.id});c.target.setX(s),c.target.setY(i);break}case ot.LINE_PANEL:{const{plot:s,color:i,strokeWidth:r,strokeDasharray:o,transform:a}=t.attr,[l,u,h,c]=s,f=this.lineManager.addLine(l,u,h,c,{width:r,color:i,dasharray:o,id:t.id});a&&f.target.setTransform(a);break}case ot.RECT_PANEL:{const{fill:s,width:i,height:r,color:o,strokeWidth:a,strokeDasharray:l,x:u,y:h,transform:c}=t.attr,f=this.rectManager.addRect(u,h,i,r,{fill:s,color:o,width:a,dasharray:l,id:t.id});c&&f.target.setTransform(c);break}default:{console.warn(`未知类型的节点: ${t.type}`);break}}}setupDragAndDrop(){const t=this;t.canvas.on("dragover",e=>{e.preventDefault()}),t.canvas.on("drop",e=>{e.preventDefault();const{offsetX:s,offsetY:i}=e,r=e.dataTransfer.getData("options");r&&t.emitter.emit(K.DRAG_DROP,{ctx:t,x:s,y:i,options:r})})}}const wo={class:"m-svg-editor"},_o={class:"m-svg-side-panel"},xo={__name:"index",props:{isToolbar:{type:Boolean,default:!0}},emits:["dragDrop","delayer"],setup(n,{expose:t,emit:e}){const s=e,i=fs(new bo);return gs(i),i.emitter.on(i.emitter_type.DRAG_DROP,r=>s("dragDrop",r)),i.emitter.on(i.emitter_type.UPDATE_CANVAS_WRAPPER,({width:r,height:o})=>be(r,o)),i.emitter.on(i.emitter_type.DELAYER,({id:r})=>{s("delayer",r)}),t({saveCanvasText(){return new Promise((r,o)=>{bs(),setTimeout(()=>{const a=i.saveCanvasText();r(a)},1e3)})},render(r){i.render(r)},generateAST:wn}),Wt(()=>{ys(),bn()}),(r,o)=>(M(),V("div",wo,[n.isToolbar?(M(),it(xs,{key:0})):re("",!0),y(Nr,null,{default:E(()=>[y(Or)]),_:1}),C("div",_o,[y(io),y(lo)])]))}},vo=nt(xo,[["__scopeId","data-v-2994d099"]]),Ze="PROVIDE_DYNAMIC_DIALOG";function Eo(){const n=fn(Ze);if(!n)throw new Error("useDynamicDialog must be called inside a <dynamic-dialog> component");return n}/*! Element Plus v2.8.5 */var ns={name:"zh-cn",el:{breadcrumb:{label:"面包屑"},colorpicker:{confirm:"确定",clear:"清空",defaultLabel:"颜色选择器",description:"当前颜色 {color}，按 Enter 键选择新颜色",alphaLabel:"选择透明度的值"},datepicker:{now:"此刻",today:"今天",cancel:"取消",clear:"清空",confirm:"确定",dateTablePrompt:"使用方向键与 Enter 键可选择日期",monthTablePrompt:"使用方向键与 Enter 键可选择月份",yearTablePrompt:"使用方向键与 Enter 键可选择年份",selectedDate:"已选日期",selectDate:"选择日期",selectTime:"选择时间",startDate:"开始日期",startTime:"开始时间",endDate:"结束日期",endTime:"结束时间",prevYear:"前一年",nextYear:"后一年",prevMonth:"上个月",nextMonth:"下个月",year:"年",month1:"1 月",month2:"2 月",month3:"3 月",month4:"4 月",month5:"5 月",month6:"6 月",month7:"7 月",month8:"8 月",month9:"9 月",month10:"10 月",month11:"11 月",month12:"12 月",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},weeksFull:{sun:"星期日",mon:"星期一",tue:"星期二",wed:"星期三",thu:"星期四",fri:"星期五",sat:"星期六"},months:{jan:"一月",feb:"二月",mar:"三月",apr:"四月",may:"五月",jun:"六月",jul:"七月",aug:"八月",sep:"九月",oct:"十月",nov:"十一月",dec:"十二月"}},inputNumber:{decrease:"减少数值",increase:"增加数值"},select:{loading:"加载中",noMatch:"无匹配数据",noData:"无数据",placeholder:"请选择"},dropdown:{toggleDropdown:"切换下拉选项"},mention:{loading:"加载中"},cascader:{noMatch:"无匹配数据",loading:"加载中",placeholder:"请选择",noData:"暂无数据"},pagination:{goto:"前往",pagesize:"条/页",total:"共 {total} 条",pageClassifier:"页",page:"页",prev:"上一页",next:"下一页",currentPage:"第 {pager} 页",prevPages:"向前 {pager} 页",nextPages:"向后 {pager} 页",deprecationWarning:"你使用了一些已被废弃的用法，请参考 el-pagination 的官方文档"},dialog:{close:"关闭此对话框"},drawer:{close:"关闭此对话框"},messagebox:{title:"提示",confirm:"确定",cancel:"取消",error:"输入的数据不合法!",close:"关闭此对话框"},upload:{deleteTip:"按 delete 键可删除",delete:"删除",preview:"查看图片",continue:"继续上传"},slider:{defaultLabel:"滑块介于 {min} 至 {max}",defaultRangeStartLabel:"选择起始值",defaultRangeEndLabel:"选择结束值"},table:{emptyText:"暂无数据",confirmFilter:"筛选",resetFilter:"重置",clearFilter:"全部",sumText:"合计"},tour:{next:"下一步",previous:"上一步",finish:"结束导览"},tree:{emptyText:"暂无数据"},transfer:{noMatch:"无匹配数据",noData:"无数据",titles:["列表 1","列表 2"],filterPlaceholder:"请输入搜索内容",noCheckedFormat:"共 {total} 项",hasCheckedFormat:"已选 {checked}/{total} 项"},image:{error:"加载失败"},pageHeader:{title:"返回"},popconfirm:{confirmButtonText:"确定",cancelButtonText:"取消"},carousel:{leftArrow:"上一张幻灯片",rightArrow:"下一张幻灯片",indicator:"幻灯片切换至索引 {index}"}}};const To=mn({name:"DialogTemplate",components:{ElConfigProvider:gn},props:{top:{type:String,default:"10vh"},width:{type:String,default:"90%"}},emits:["closed"],setup(n,{emit:t}){const e=W(!1),s=()=>{e.value=!1},i=()=>{t("closed")};return ze(Ze,{close:s}),ie(()=>{e.value=!0}),{visible:e,close:s,handleClosed:i,zhCn:ns}}});function So(n,t,e,s,i,r){const o=Zt("ElConfigProvider"),a=Zt("ElDialog");return M(),it(a,{modelValue:n.visible,"onUpdate:modelValue":t[0]||(t[0]=l=>n.visible=l),width:n.width,top:n.top,class:"dialog-template","append-to-body":"",onClosed:n.handleClosed},{default:E(()=>[y(o,{locale:n.zhCn},{default:E(()=>[Oe(n.$slots,"default")]),_:3},8,["locale"])]),_:3},8,["modelValue","width","top","onClosed"])}const Ao=nt(To,[["render",So]]),Do=mn({name:"DrawerTemplate",components:{ElConfigProvider:gn},props:{size:{type:String,default:"50%"}},emits:["closed"],setup(n,{emit:t}){const e=W(!1),s=()=>{e.value=!1},i=()=>{t("closed")};return ze(Ze,{close:s}),ie(()=>{e.value=!0}),{visible:e,close:s,handleClosed:i,zhCn:ns}}});function Co(n,t,e,s,i,r){const o=Zt("ElConfigProvider"),a=Zt("ElDrawer");return M(),it(a,{modelValue:n.visible,"onUpdate:modelValue":t[0]||(t[0]=l=>n.visible=l),size:n.size,class:"drawer-template","append-to-body":"",onClosed:n.handleClosed},{default:E(()=>[y(o,{locale:n.zhCn},{default:E(()=>[Oe(n.$slots,"default")]),_:3},8,["locale"])]),_:3},8,["modelValue","size","onClosed"])}const ko=nt(Do,[["render",Co]]),dn={};function Mo(){return document.createElement("div")}const Po={closeOnClickModal:!1,closeOnPressEscape:!1},Fo={drawer:ko,dialog:Ao},Ro="drawer";function No(){let n=1;const t=new Map,e=ps(),{appContext:s}=e;Wt(()=>{r()});function i(o={},a,l={}){let u=Mo();u.className="dynamic-dialog";let h=a;dn[a]&&(h=dn[a]);function c(){nn(null,u),u=null,t.delete(n)}const{type:f,...d}=o,g=f||Ro,p={...Po,onClosed:c,...d},w=en(Fo[g],p,()=>en(h,l));w.appContext=s,nn(w,u),t.set(n,w.component),n++}function r(){t.forEach(o=>{o.proxy.close()}),t.clear()}return{load:i,close:r}}const zo={class:"read-write"},Oo={class:"read-write__head"},Ho={class:"head-btn"},Lo={class:"read-write__body"},Io={class:"body__left"},Vo={class:"base-info"},Bo={class:"control"},$o={__name:"read-write",setup(n){const t=W(null),e=Eo(),s=W({a1:"LED屏1",a2:""}),i=[{label:"门禁系统",children:[{label:"${外来人员}",value:1},{label:"${外来车辆}",value:2}]},{label:"员工统计",children:[{label:"${在册员工}",value:3},{label:"${离职员工}",value:5}]}],r={children:"children",label:"label"},o={text:{t:"text",content:"文本标签"},line:{t:"line"},rect:{t:"rect"},table:{t:"table",content:"${外来人员}"}};function a(f,d){const g=o[d];f.dataTransfer.setData("options",JSON.stringify(g))}function l(f){const{ctx:d,x:g,y:p,options:w}=f,{t:A,content:z}=JSON.parse(w);switch(A){case"text":{d.textManager.addText(g,p,z);break}case"line":{d.lineManager.addLine(g,p,g+100,p);break}case"rect":{d.rectManager.addRect(g,p,100,50);break}}}function u(f){console.log(f)}function h(){const f=JSON.stringify([{id:"SvgjsRect1000",label:"背景",type:"background-panel",attr:{width:800,height:600,fill:"#ffffff"},children:[{id:"SvgjsText1002",label:"文字标签",type:"text-panel",attr:{x:3,y:17.5,content:"文本标签",fontSize:16,fill:"#000000",fontFamily:"宋体",fontWeight:"normal",fontStyle:"normal"},children:[]}]}]);t.value.render(f)}async function c(){const f=await t.value.saveCanvasText();console.log(f)}return(f,d)=>(M(),V("div",zo,[C("div",Oo,[d[11]||(d[11]=C("h2",{class:"head-title"},"信息发布",-1)),C("div",Ho,[y(m(Kt),{onClick:h},{default:E(()=>d[7]||(d[7]=[Ft("渲染")])),_:1}),y(m(Kt),null,{default:E(()=>d[8]||(d[8]=[Ft("发布")])),_:1}),y(m(Kt),{onClick:c},{default:E(()=>d[9]||(d[9]=[Ft("保存")])),_:1}),y(m(Kt),{onClick:d[0]||(d[0]=()=>m(e).close())},{default:E(()=>d[10]||(d[10]=[Ft("退出")])),_:1})])]),C("div",Lo,[C("div",Io,[C("div",Vo,[y(m(jt),null,{default:E(()=>[y(m(I),null,{default:E(()=>[y(m(yt),{modelValue:s.value.a1,"onUpdate:modelValue":d[1]||(d[1]=g=>s.value.a1=g),readonly:""},null,8,["modelValue"])]),_:1}),y(m(I),null,{default:E(()=>[y(m(yt),{modelValue:s.value.a2,"onUpdate:modelValue":d[2]||(d[2]=g=>s.value.a2=g),placeholder:"标题"},null,8,["modelValue"])]),_:1})]),_:1})]),C("div",Bo,[C("div",{draggable:"true",onDragstart:d[3]||(d[3]=g=>a(g,"text"))}," 文本 ",32),C("div",{draggable:"true",onDragstart:d[4]||(d[4]=g=>a(g,"line"))}," 直线 ",32),C("div",{draggable:"true",onDragstart:d[5]||(d[5]=g=>a(g,"rect"))}," 矩形 ",32),C("div",{draggable:"true",onDragstart:d[6]||(d[6]=g=>a(g,"table"))}," 业务数据 ",32)]),d[12]||(d[12]=C("div",{class:"dynamic-info"},[C("h3",{class:"dynamic-info__title"},"动态信息")],-1)),y(m(pn),{data:i,props:r})]),y(m(vo),{ref_key:"editorRef",ref:t,"is-toolbar":!1,onDragDrop:l,onDelayer:u},null,512)])]))}},jo=nt($o,[["__scopeId","data-v-5c2beeb7"]]),Wo={class:"svg-editor"},Yo={__name:"index",setup(n){const t=No();function e(){t.load({title:"信息发布",type:"dialog",fullscreen:!0,modalClass:"info-play-dialog"},jo)}return(s,i)=>(M(),V("div",Wo,[C("button",{onClick:e},"Open")]))}},Zo=nt(Yo,[["__scopeId","data-v-e6f90050"]]);export{Zo as default};
